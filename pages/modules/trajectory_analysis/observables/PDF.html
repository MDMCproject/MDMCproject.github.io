

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>PDF &mdash; MDMC 0.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="SQw_coh" href="SQw_coh.html" />
    <link rel="prev" title="obs" href="obs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> MDMC
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../simulations.html">3. Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../parameter-refinement.html">4. Parameter Refinement</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/building-a-universe.html">Building an MDMC Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/solvating-a-universe.html">Solvating an MDMC Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/running-a-simulation.html">Running a Simulation in MDMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/selecting-fitting-parameters.html">Selecting Fitting Parameters</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../common.html">Common</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../control.html">Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gui.html">gui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../md.html">MD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../readers.html">readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../refinement.html">refinement</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../trajectory_analysis.html">trajectory_analysis</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../trajectory.html">trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="obs_factory.html">obs_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="obs.html">obs</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="SQw_coh.html">SQw_coh</a></li>
<li class="toctree-l2"><a class="reference internal" href="SQw_incoh.html">SQw_incoh</a></li>
<li class="toctree-l2"><a class="reference internal" href="SQw.html">SQw</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">MDMC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../trajectory_analysis.html">trajectory_analysis</a> &raquo;</li>
        
      <li>PDF</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/pages/modules/trajectory_analysis/observables/PDF.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-MDMC.trajectory_analysis.observables.PDF">
<span id="pdf"></span><h1>PDF<a class="headerlink" href="#module-MDMC.trajectory_analysis.observables.PDF" title="Permalink to this headline">¶</a></h1>
<p>Module for calculating the pair distribution function (PDF)</p>
<dl class="class">
<dt id="MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction">
<em class="property">class </em><code class="sig-prename descclassname">MDMC.trajectory_analysis.observables.PDF.</code><code class="sig-name descname">PairDistributionFunction</code><a class="reference internal" href="../../../../_modules/MDMC/trajectory_analysis/observables/PDF.html#PairDistributionFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>A class for containing, calculating and reading a pair distribution
function</p>
<dl class="method">
<dt id="MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.calculate_from_MD">
<code class="sig-name descname">calculate_from_MD</code><span class="sig-paren">(</span><em class="sig-param">MD_input</em>, <em class="sig-param">**settings</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/MDMC/trajectory_analysis/observables/PDF.html#PairDistributionFunction.calculate_from_MD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.calculate_from_MD" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the pair distribution function, <span class="math notranslate nohighlight">\(G(r)\)</span> from a
Trajectory</p>
<p>The total pair distribution function (<code class="docutils literal notranslate"><span class="pre">pdf.PDF</span></code>) has the form:</p>
<div class="math notranslate nohighlight">
\[G(r) = \sum_{i,j}^{N_{elements}} c_ic_jb_ib_j(g_{ij}(r) - 1)\]</div>
<p>where <span class="math notranslate nohighlight">\(c_i\)</span> is the number concentration of element <span class="math notranslate nohighlight">\(i\)</span>,
<span class="math notranslate nohighlight">\(b_i\)</span> is the (coherent) scattering length of element <span class="math notranslate nohighlight">\(i\)</span>,
and the partial pair distribution, <span class="math notranslate nohighlight">\(g_{ij}\)</span>, is:</p>
<div class="math notranslate nohighlight">
\[g_{ij}(r) = \frac{h_{ij}(r)}{4 \pi r^2 \rho_{j} \Delta{r}}\]</div>
<p>where <span class="math notranslate nohighlight">\(h_{ij}\)</span> is the histogram of distances of <span class="math notranslate nohighlight">\(j\)</span> element
atoms around atoms of element <span class="math notranslate nohighlight">\(i\)</span>, with bins of size
<span class="math notranslate nohighlight">\(\Delta{r}\)</span>, and <span class="math notranslate nohighlight">\(\rho_{j}\)</span> is the number density of
atoms of element <span class="math notranslate nohighlight">\(j\)</span>. As <span class="math notranslate nohighlight">\(g_{ij}(0) = 0\)</span>, it is evident that
<span class="math notranslate nohighlight">\(G(0) = -\sum_{i,j}^{N_{elements}} c_ic_jb_ib_j\)</span>.</p>
<p>Independent variables can either be set previously or defined within
settings.</p>
<p>A number of frames can be specified, from which the pdf and its error
are calculated. If the number of frames is too large relative to the run
length, the samples will be correlated, which will result in an
underestimate of the error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>MD_input</strong> (<a class="reference internal" href="../trajectory.html#MDMC.trajectory_analysis.trajectory.Trajectory" title="MDMC.trajectory_analysis.trajectory.Trajectory"><em>Trajectory</em></a>) – An MD Trajectory</p></li>
<li><p><strong>**settings</strong> – <dl class="simple">
<dt>n_frames<span class="classifier">int</span></dt><dd><p>The number of frames from which the pdf and its error are
calculated. If this is not passed, 1% of the total number of
frames are used (rounded up to nearest int).</p>
</dd>
<dt>subset<span class="classifier">list of tuples</span></dt><dd><p>The subset of element pairs from which the PDF is calculated.
This can be used to calculate the partial PDFs of a
multicomponent system. If this is not passed, all combinations
of elements are used i.e. the PDF is the total PDF.</p>
</dd>
<dt>b_coh<span class="classifier">dict</span></dt><dd><p>Definitions of the coherent neutron scattering lengths for one
or more elements. This can be used to calculate the PDF of a
system where one or more elements has a coherent scattering
length different from the coherent scattering length in
MDMC.common.atom_properties (i.e. if it has been isotopically
substituted).</p>
</dd>
<dt>r_min<span class="classifier">float</span></dt><dd><p>The minimum r (atomic separation) for which the PDF will be
calculated. If this, r_max, and r_step are passed then these
will create a range for the independent variable r, which will
overwrite any r which has previously been defined. This cannot
be passed if r is passed.</p>
</dd>
<dt>r_max<span class="classifier">float</span></dt><dd><p>The maximum r (atomic separation) for which the PDF will be
calculated. If this, r_min, and r_step are passed then these
will create a range for the independent variable r, which will
overwrite any r which has previously been defined. This cannot
be passed if r is passed.</p>
</dd>
<dt>r_step<span class="classifier">float</span></dt><dd><p>The step size of r (atomic separation) for which the PDF will be
calculated. If this, r_min, and r_max are passed then these
will create a range for the independent variable r, which will
overwrite any r which has previously been defined. This cannot
be passed if r is passed.</p>
</dd>
<dt>r<span class="classifier">array</span></dt><dd><p>The uniform r values for which the PDF will be calculated. This
cannot be passed if r_min, r_max, and r_step are passed.</p>
</dd>
<dt>dimensions<span class="classifier">array-like</span></dt><dd><p>A 3 element array-like (list, tuple) with the dimensions of the
Universe.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To calculate the O-O partial PDF from a simulation of water, use the
subset keyword:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>pdf.calculate_from_MD(trajectory, subset=[(O, O)])</p>
</div></blockquote>
<p>To calculate the sum of the H-O and O-O partial PDFs:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>pdf.calculate_from_MD(trajectory, subset=[(O, O), (H, O)])</p>
</div></blockquote>
<p>To calculate the total PDF for sodium chloride with 37Cl:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>pdf.calculate_from_MD(trajectory, b_coh={‘Cl’:3.08})</p>
</div></blockquote>
<p>To calculate the total PDF for r values of [1., 2., 3., 4., ]:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>pdf.calculate_from_MD(trajectory, b_coh={‘Cl’:3.08})</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.data" title="Permalink to this definition">¶</a></dt>
<dd><p>The independent, dependent and error data in the Observable</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The independent, dependent and error data</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.dependent_variables">
<em class="property">property </em><code class="sig-name descname">dependent_variables</code><a class="headerlink" href="#MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.dependent_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the dependent variables, the pair distribution function (in
arb)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The dependent_variables</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.errors">
<em class="property">property </em><code class="sig-name descname">errors</code><a class="headerlink" href="#MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the errors on the dependent variables, the pair distribution
function (in arb)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The errors on the dependent variables</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.independent_variables">
<em class="property">property </em><code class="sig-name descname">independent_variables</code><a class="headerlink" href="#MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.independent_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the independent variables, the atomic separation distance r
(in Ang)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The independent_variables</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.r">
<em class="property">property </em><code class="sig-name descname">r</code><a class="headerlink" href="#MDMC.trajectory_analysis.observables.PDF.PairDistributionFunction.r" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the value of the atomc separation distance (in Ang)</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="SQw_coh.html" class="btn btn-neutral float-right" title="SQw_coh" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="obs.html" class="btn btn-neutral float-left" title="obs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Thomas Farmer

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>