<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Units in MDMC &mdash; MDMC 0.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Applying a ForceField" href="applying-a-forcefield.html" />
    <link rel="prev" title="Reading atoms from configuration files" href="read-configurations.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MDMC
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/simulations.html">3. Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/parameter-refinement.html">4. Parameter Refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/contributing.html">5. Contributing to MDMC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="building-a-universe.html">Building an MDMC Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="read-configurations.html">Reading atoms from configuration files</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Units in MDMC</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#SYSTEM-Units">SYSTEM Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Exceptional-Cases">Exceptional Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Converting-Units">Converting Units</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="applying-a-forcefield.html">Applying a <code class="docutils literal notranslate"><span class="pre">ForceField</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="solvating-a-universe.html">Solvating an MDMC Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="molecular-visualization.html">Molecular Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="running-a-simulation.html">Running a Simulation in MDMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating-an-observable.html">Creating an Observable from a Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="selecting-fitting-parameters.html">Selecting Fitting Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="running-a-refinement.html">Running a Refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="Argon-a-to-z.html">Argon A-to-Z</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/developer/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/developer/coding_standards.html">Coding Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/developer/documentation.html">Documentation Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/developer/units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/developer/testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/developer/management.html">MDMC Software Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/developer/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/developer/vscode.html">Debugging inside Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/developer/recipes.html">Recipes for ‘simple’ additions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/common.html">common</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/control.html">control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/gui.html">gui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/md.html">MD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/readers.html">readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/refinement.html">refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/trajectory_analysis.html">trajectory_analysis</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MDMC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Units in MDMC</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/units.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Units-in-MDMC">
<h1>Units in MDMC<a class="headerlink" href="#Units-in-MDMC" title="Permalink to this headline"></a></h1>
<div class="section" id="SYSTEM-Units">
<h2>SYSTEM Units<a class="headerlink" href="#SYSTEM-Units" title="Permalink to this headline"></a></h2>
<p>All quantities passed as arguments and returned as outputs in MDMC have units associated with them. In general, these units are consistent across all functions and are referred to as the <code class="docutils literal notranslate"><span class="pre">SYSTEM</span></code> units associated with a physical property:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">MDMC.common</span> <span class="kn">import</span> <span class="n">units</span>

<span class="nb">print</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">SYSTEM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;LENGTH&#39;: &#39;Ang&#39;, &#39;TIME&#39;: &#39;fs&#39;, &#39;MASS&#39;: &#39;amu&#39;, &#39;CHARGE&#39;: &#39;e&#39;, &#39;ANGLE&#39;: &#39;deg&#39;, &#39;TEMPERATURE&#39;: &#39;K&#39;, &#39;ENERGY&#39;: &#39;kJ / mol&#39;, &#39;FORCE&#39;: &#39;kJ / Ang mol&#39;, &#39;PRESSURE&#39;: &#39;Pa&#39;, &#39;ENERGY_TRANSFER&#39;: &#39;meV&#39;, &#39;ARBITRARY&#39;: &#39;arb&#39;}
</pre></div></div>
</div>
<p>For example, both the <code class="docutils literal notranslate"><span class="pre">Atom</span></code> and <code class="docutils literal notranslate"><span class="pre">Universe</span></code> expect units of <code class="docutils literal notranslate"><span class="pre">Ang</span></code> for <code class="docutils literal notranslate"><span class="pre">LENGTH</span></code> properties (the <code class="docutils literal notranslate"><span class="pre">position</span></code> and <code class="docutils literal notranslate"><span class="pre">dimensions</span></code> arguments respectively):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">MDMC.MD</span> <span class="kn">import</span> <span class="n">Atom</span><span class="p">,</span> <span class="n">Universe</span>

<span class="nb">print</span><span class="p">(</span><span class="n">help</span><span class="p">(</span><span class="n">Atom</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">help</span><span class="p">(</span><span class="n">Universe</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on class Atom in module MDMC.MD.structural_units:

class Atom(StructuralUnit)
 |  Atom(element, position=(0.0, 0.0, 0.0), velocity=(0.0, 0.0, 0.0), charge=None, **settings)
 |
 |  A single atom
 |
 |  Parameters
 |  ----------
 |  element : str
 |      The atomic element label.
 |  position : list, tuple, numpy.ndarray, optional
 |      A 3 element `list`, `tuple` or ``array`` with the position in units of
 |      ``Ang``. The default is ``(0., 0., 0.)``.
 |  velocity : list, tuple, numpy.ndarray, optional
 |      A 3 element `list`, `tuple` or ``array`` with the velocity in units of
 |      ``Ang / fs``. Note that if set, the velocity of atoms in the MD engine will
 |      be scaled when creating a `Simulation` in order to ensure the
 |      temperature is accurate. Otherwise, if the velocities of all `Atom`
 |      objects in a `Simulation` are 0, then the velocities of the atoms in
 |      the MD engine will be randomly chosen in order to provide an accurate
 |      temperature. The default is ``(0., 0., 0.)``.
 |  charge : float
 |      The charge of the ``Atom`` in units of elementary charge (``e)``. The
 |      default is `None`, meaning that a ``Coulomb`` interaction is not applied
 |      to the ``Atom``.
 |  **settings
 |      ``mass`` (`float`)
 |          The atomic mass in ``amu``. If not provided a lookup table will be
 |          used.
 |      ``atom_type`` (`int`)
 |          All atoms with the same atom_type will have the same non-bonded interactions
 |          applied to them. If not provided, MDMC will automatically infer/assign atom types.
 |          All atoms with the same element and interactions will have the same atom type.
 |      ``name`` (`str`)
 |          A name to uniquely identify the atom. Used by ForceFields (e.g. OPLSAA). Atoms
 |          should only have the same names if they are equivalent. Defaults to the element
 |          of the atom.
 |  Attributes
 |  ----------
 |  element : str
 |      The atomic element label
 |
 |  Method resolution order:
 |      Atom
 |      StructuralUnit
 |      abc.ABC
 |      builtins.object
 |
 |  Methods defined here:
 |
 |  __deepcopy__(self, memo)
 |      Copies the Atom and all attributes, except ``ID`` which is generated
 |
 |      Interactions are copied but the copied ``Atom`` is substituted for the
 |      original ``Atom``.  For ``BondedInteractions`` this means that the
 |      copied ``Atom`` will be bonded to all atoms to which the original
 |      ``Atom`` is bonded.
 |
 |      Arguments
 |      ---------
 |      memo : dict
 |          The memoization `dict`
 |
 |  __init__(self, element, position=(0.0, 0.0, 0.0), velocity=(0.0, 0.0, 0.0), charge=None, **settings)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |
 |  __repr__(self)
 |
 |  __str__(self)
 |      Returns
 |      -------
 |      str
 |          The ``element``, ``charge`` and ``position`` of the ``Atom``
 |
 |  add_interaction(self, interaction, from_interaction=False)
 |      Adds an interaction to the ``Atom``
 |
 |      Parameters
 |      ----------
 |      interaction : MDMC.MD.interactions.Interaction
 |          Any class dervied from ``Interaction``, or any object with base
 |          class ``Interaction``.  If an ``Interaction`` class is passed then
 |          it must be a ``NonBondedInteraction`` i.e. only takes a single
 |          ``Atom`` as an argument. If an ``Interaction`` object is passed then
 |          this ``Atom`` must be in the ``interaction.atoms``.
 |      from_interaction : bool, optional
 |          Specifies if this method has been called from an ``Interaction``.
 |          Default is `False`.
 |
 |  copy(self, position)
 |      Copies the ``Atom`` and all attributes, except ``ID`` which is generated
 |
 |      Copying an ``Atom`` creates an exact duplicate at the specified
 |      ``position``.  The copied ``Atom`` will have identical bonded and
 |      nonbonded interactions as the original. For ``BondedInteractions`` this
 |      means that the copied atom will be bonded to all atoms to which the
 |      original atom is bonded. The ``ID`` of the copied atom will differ from
 |      the original, as they are sequentially generated.
 |
 |      Parameters
 |      ----------
 |      position : list, tuple, numpy.ndarray
 |          A 3 element `list`, `tuple` or ``array`` with the ``position`` of
 |          the new ``Atom``
 |
 |      Returns
 |      -------
 |      Atom
 |          A copy of the ``Atom`` with the specified ``position``
 |
 |      Examples
 |      --------
 |      If the following ``Atom`` is copied:
 |
 |      .. highlight:: python
 |      .. code-block:: python
 |
 |          H1 = Atom(&#39;H&#39;, position=(0., 0., 0.), charge=0.4238)
 |          H2 = H1.copy(position=(1., 1., 1.))
 |
 |      then the new ``Atom`` (``H2``) will have no ``BondedInteractions``, but
 |      will have a ``Coulombic`` interaction, with a ``charge`` of ``0.4238 e``
 |
 |      If ``H1`` and ``H2`` are then bonded together and a copy is made:
 |
 |      .. highlight:: python
 |      .. code-block:: python
 |
 |          HHbond = Bond((H1, H2))
 |          H3 = H1.copy(position=(2., 2., 2.))
 |
 |      then the newest ``Atom`` (``H3``) will have a ``Coulombic`` interaction
 |      (also with a ``charge`` of ``0.4238 e``), and it will also have a
 |      ``Bond`` interaction with ``H2`` (as ``H1`` had a ``Bond`` interaction
 |      with ``H2``).
 |
 |  copy_interactions(self, atom, memo={})
 |      This replicates the interactions from ``self`` for ``Atom``, but with
 |      ``self`` substituted by ``atom`` in the ``Interaction.atoms``. These
 |      interactions are added to any that already exist for the ``Atom``.
 |
 |      Passing the ``memo`` `dict` enables specific interactions to be excluded
 |      from being copied, duplicating the behaviour of ``__deepcopy__``
 |
 |      Parameters
 |      ----------
 |      atom : Atom
 |          The ``Atom`` for which ``self.interactions`` are being replicated
 |      memo : dict, optional
 |          The memoization `dict`
 |
 |  ----------------------------------------------------------------------
 |  Readonly properties defined here:
 |
 |  atoms
 |      Get a `list` of the atoms, just consisting of the ``Atom``
 |
 |      Returns
 |      -------
 |      list
 |          A `list` with a single item, the ``Atom``
 |
 |  bonded_interaction_pairs
 |      Get bonded interactions acting on the ``Atom`` and the other atoms
 |      to which the ``Atom`` is bonded
 |
 |
 |      Returns
 |      -------
 |      list
 |          (``interaction``, ``atoms``) pairs acting on the ``Atom``, where
 |          ``atoms`` is a `tuple` of all `Atom` objects for that specific
 |          bonded ``interaction``.
 |
 |      Example
 |      -------
 |      For an O ``Atom`` with two bonds, one to H1 and one to H2::
 |
 |          &gt;&gt;&gt; print(O.bonded_interaction_pairs)
 |          [(Bond, (H1, O)), (Bond, (H2, O))]
 |
 |  nonbonded_interactions
 |      Get a `list` of the nonbonded interactions acting on the ``Atom``
 |
 |      Returns
 |      -------
 |      list
 |          ``NonBondedInteractions`` acting on the ``Atom``
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |
 |  atom_type
 |      Get or set the atom type of the ``Atom``
 |
 |      Returns
 |      -------
 |      int
 |          The atom type
 |
 |      Raises
 |      ------
 |      AttributeError
 |          The ``atom_type`` cannot be changed once it has been set
 |
 |  charge
 |      Get or set the charge in ``e`` if one has been applied to the ``Atom``
 |
 |      If the ``Atom`` does not have a ``Coulombic`` interaction, setting a
 |      value of the ``charge`` will create one, and a default ``cutoff`` of
 |      ``10. Ang`` will be applied
 |
 |      Returns
 |      -------
 |      float
 |          The charge in units of ``e``, or `None` if no charge has been set
 |
 |      Raises
 |      ------
 |      ValueError
 |          When the ``Atom`` has more than one ``Coulombic`` interaction
 |      ValueError
 |          When the ``Atom`` has more than one parameter; i.e. should only
 |          have charge as a parameter
 |      ValueError
 |          When setting charge to `None` when a ``Coulombic`` interaction
 |          already exists.
 |
 |  mass
 |      Get or set the atomic mass in ``amu``
 |
 |      Returns
 |      -------
 |      float
 |          the atomic mass in ``amu``
 |
 |  universe
 |      Get the ``Universe`` to which the ``Atomm`` belongs
 |
 |      Returns
 |      -------
 |      Universe
 |          The ``Universe`` to which the ``Atom`` belongs or `None`
 |
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |
 |  __abstractmethods__ = frozenset()
 |
 |  ----------------------------------------------------------------------
 |  Methods inherited from StructuralUnit:
 |
 |  translate(self, displacement)
 |      Translate the structural unit by the specified displacement
 |
 |      Parameters
 |      ----------
 |      Displacement : tuple, numpy.ndarray
 |          A three element tuple or ``array`` of `float`
 |
 |  valid_position(self, position=None)
 |      Checks if the specified ``position`` is within the bounds of the
 |      ``StructuralUnit.universe``, if it has one
 |
 |      Parameters
 |      ----------
 |      position : list, tuple, numpy.ndarray
 |          3 element `list`, `tuple` or ``array`` with units of ``Ang`` or
 |          `None`. If `None` then the ``position`` of the ``StructuralUnit`` is
 |          used.
 |
 |      Returns
 |      -------
 |      bool
 |          `True` if ``position`` is within ``Universe`` or there is no
 |          associated ``Universe``. `False` if ``StructuralUnit`` has an
 |          associated ``Universe`` but the ``position`` is not within its
 |          bounds.
 |
 |      Raises
 |      ------
 |      ValueError
 |          If ``position`` if undefined
 |
 |  ----------------------------------------------------------------------
 |  Readonly properties inherited from StructuralUnit:
 |
 |  bonded_interactions
 |      Get a list of the bonded interactions acting on the ``StructuralUnit``
 |
 |      Returns
 |      -------
 |      list
 |          ``BondedInteractions`` acting on the ``StructuralUnit``
 |
 |  bounding_box
 |      Returns
 |      -------
 |      BoundingBox
 |          Contains the lower and upper extents of the ``Molecule``
 |
 |  interactions
 |      Get a list of the interactions acting on the ``StructuralUnit``
 |
 |      Returns
 |      -------
 |      list
 |          Interactions acting on the ``StructuralUnit``
 |
 |  structure_type
 |      Get the class of the ``StructuralUnit``.
 |
 |      Returns
 |      -------
 |      str
 |          The name of the class
 |
 |  top_level_structure
 |      Get the top level structure (i.e. ``StructuralUnit`` which has no
 |      ``parent``) of the ``StructuralUnit``
 |
 |      Returns
 |      -------
 |      StructuralUnit
 |          Highest level ``StructuralUnit`` of which it is a member
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors inherited from StructuralUnit:
 |
 |  __dict__
 |      dictionary for instance variables (if defined)
 |
 |  __weakref__
 |      list of weak references to the object (if defined)
 |
 |  position
 |      Get or set the position of the center of mass of the ``StructuralUnit``
 |      in ``Ang``
 |
 |      Returns
 |      -------
 |      numpy.ndarray
 |
 |  velocity
 |      Get or set the velocity of the ``StructuralUnit`` in ``Ang/fs``
 |
 |      Returns
 |      -------
 |      numpy.ndarray

None
Help on class Universe in module MDMC.MD.simulation:

class Universe(MDMC.MD.container.AtomContainer)
 |  Universe(dimensions, force_field=None, structures=None, **settings)
 |
 |  Class where the configuration and topology are defined
 |
 |  Parameters
 |  ----------
 |  dimensions : numpy.ndarray, list, float
 |      Dimensions of the ``Universe``, in units of ``Ang``. A `float` can be
 |      used for a cubic universe.
 |  force_field : ForceField, optional
 |      A force field to apply to the Universe. The force fields available are:
 |      OPLSAA, SPCE, TIP3P, TIP3PFB, SPC. Default is None.
 |  structures : list, optional
 |      Either ``StructuralUnit`` objects contained in the ``Universe`` or their
 |      ``ID`` (`int`). Default is None.
 |  **settings
 |      ``kspace_solver`` (`KSpaceSolver`)
 |          The k-space solver to be used for both electrostatic and dispersive
 |          interactions. If this is passed then no ``electrostatic_solver`` or
 |          ``dispersive_solver`` may be passed.
 |      ``electrostatic_solver`` (`KSpaceSolver`)
 |          The k-space solver to be used for electrostatic interactions.
 |      ``dispersive_solver`` (`KSpaceSolver`)
 |          The k-space solver to be used for dispersive interactions.
 |      ``constraint_algorithm`` (`ConstraintAlgorithm`)
 |          The constraint algorithm which will be applied to constrained
 |          ``BondedInteractions``.
 |
 |  Attributes
 |  ----------
 |  dimensions : numpy.ndarray, list, float
 |      Dimensions of the ``Universe`` in units of ``Ang``.
 |  configuration : Configuration
 |      Stores the content, i.e. configuration of atoms etc within the universe
 |  force_field : ForceField or None
 |      Force field to apply to the Universe
 |  kspace_solver : KSpaceSolver
 |      The k-space solver to be used for both electrostatic and dispersive
 |      interactions.
 |  electrostatic_solver : KSpaceSolver
 |      The k-space solver to be used for electrostatic interactions.
 |  dispersive_solver : KSpaceSolver
 |      The k-space solver to be used for dispersive interactions.
 |  constraint_algorithm : ConstraintAlgorithm
 |      The constraint algorithm which will be applied to constrained
 |      ``BondedInteractions``.
 |
 |  Method resolution order:
 |      Universe
 |      MDMC.MD.container.AtomContainer
 |      abc.ABC
 |      builtins.object
 |
 |  Methods defined here:
 |
 |  __eq__(self, other)
 |      Return self==value.
 |
 |  __init__(self, dimensions, force_field=None, structures=None, **settings)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |
 |  __repr__(self)
 |
 |  __str__(self)
 |      Return str(self).
 |
 |  add_bonded_interaction_pairs(self, *bonded_interaction_pairs)
 |      Adds one or more interaction pairs to the ``Universe``
 |
 |      Parameters
 |      ----------
 |      *bonded_interaction_pairs
 |          one or more (``interaction``, ``atoms``) pairs, where ``atoms`` is a
 |          `tuple` of all atoms for that specific bonded ``interaction``
 |
 |  add_force_field(self, force_field, *interactions, **settings)
 |      Adds a force field to the specified ``interactions``.  If no
 |      ``interactions`` are passed, the force field is applied to all
 |      interactions in the ``Universe``.
 |
 |      Parameters
 |      ----------
 |      force_field : str
 |          The ``ForceField`` to parameterize ``interactions`` (if provided),
 |          or all the ``interactions`` in the ``Universe``. The available
 |          ``ForceField`` are:
 |          OPLSAA, SPCE, TIP3P, TIP3PFB, SPC
 |      *interactions
 |          ``Interaction`` objects to parameterize with the ``ForceField``
 |      **settings
 |          ``add_dispersions`` (`bool` or `list` of ``Atoms``)
 |              If `True`, a ``Dispersion`` interaction will be added to all
 |              atoms in the ``Universe``. If a list of ``Atom`` objects is
 |              provided, the ``Dispersion`` will be added to these instead. Any
 |              added ``Dispersion`` interactions (and any previously defined)
 |              will then be parametrized by the ``ForceField``. The
 |              ``Dispersion`` interactions added will only be like-like. By
 |              default, no ``Dispersion`` interactions are added.
 |
 |  add_nonbonded_interaction(self, *nonbonded_interactions)
 |      Adds one or more nonbonded interactions to the ``Universe``
 |
 |      Parameters
 |      ----------
 |      *nonbonded_interactions
 |          Nonbonded interactions to be added to the ``Universe``.
 |          Can take any number of non-bonded interactions:
 |              ``Dispersion()``:
 |                  either Lennard-Jones or Buckingham dispersion
 |              ``Coulombic()``:
 |                  normal or modified Coulomb interaction
 |          with appropriate parameters for the interaction.
 |          See http://mdmcproject.org/tutorials/building-a-universe.html?highlight=interaction#Create-non-bonded-interactions
 |          for more details on non-bonded interactions.
 |
 |  add_structural_unit(self, structural_unit, force_field=None, center=False)
 |      Adds a single ``StructuralUnit`` to the ``Universe``, with optional
 |      ``ForceField`` applying only to that ``StructuralUnit``
 |
 |      Parameters
 |      ----------
 |      structural_unit : StructuralUnit or int
 |          The ``StructuralUnit`` (or its ``ID`` as an `int`) to be added to
 |          the ``Universe``
 |      force_field : str, optional
 |          The force field to be applied to the structural_unit. The available
 |          ``ForceField`` are:
 |          OPLSAA, SPCE, TIP3P, TIP3PFB, SPC
 |      center : bool, optional
 |          Whether to center `structural_unit` within the Universe as it is
 |          added
 |
 |  fill(self, structural_unit: MDMC.MD.structural_units.StructuralUnit, force_field: str = None, num_density: float = None, num_struc_units: int = None)
 |      A liquid-like filling of the ``Universe`` independent of existing atoms
 |
 |      Adds copies of ``structural_unit`` to existing configuration until
 |      ``Universe`` is full.  As exclusion region is defined by the size of a
 |      bounding sphere, this method is most suitable for atoms or molecules
 |      with approximately equal dimensions.
 |
 |      .. note:: CURRENT APPROACH RESULTS IN NUMBER DENSITY DIFFERENT TO WHAT
 |                IS SPECIFIED DEPENDING ON HOW CLOSE CUBE ROOT OF N_MOLECULES
 |                IS TO AN `int`.
 |
 |      .. note:: CURRENT IMPLEMENTATION SHOULD NOT BE USED WITH NON-CUBIC
 |                UNIVERSES AS THE DENSITY MAY OR MAY NOT BE ISOTROPIC
 |                DEPENDING ON THE DIMENSIONS AND NUMBER OF UNITS.
 |
 |      Parameters
 |      ----------
 |      structural_unit : StructuralUnit or int
 |          The ``StructuralUnit`` (or its ``ID`` as an `int`) with which to
 |          fill the ``Universe``
 |      force_field : str
 |          Applies a ``ForceField`` to the ``Universe``. The available
 |          ``ForceField`` are:
 |          OPLSAA, SPCE, TIP3P, TIP3PFB, SPC
 |      num_density: float
 |          Non-negative `float` specifying the number density of the
 |          ``StructuralUnit``, in units of ``StructuralUnit / Ang ^ -3``
 |      num_struc_units: int
 |          Non-negative `int` specifying the number of passed
 |          ``StructuralUnit`` objects that the universe should be filled
 |          with, regardless of ``Universe.dimensions``.
 |
 |      Raises
 |      ------
 |      ValueError
 |          If both ``num_density`` and ``num_struc_units`` are passed
 |      ValueError
 |          If neither ``num_density`` or ``num_struc_units`` are passed
 |
 |  solvate(self, density, tolerance=1.0, solvent=&#39;SPCE&#39;, **settings)
 |      Fills the ``Universe`` with solvent molecules according to pre-defined
 |      coordinates.
 |
 |      Parameters
 |      ----------
 |      density : float
 |          The desired density of the ``Solvent`` that solvates the
 |          ``Universe``, in units of ``amu Ang ^ -3``
 |      tolerance : float, optional
 |          The +/- percentage tolerance of the density to be achieved.
 |          The default is 1 %. Tolerances of less than 1 % are at risk
 |          of not converging.
 |      solvent : str, optional
 |          A `str` specifying an inbuilt ``Solvent`` from the following:
 |          SPC, SPCE, TIP3P, TIP3PFB.
 |          The default is &#39;SPCE&#39;.
 |      **settings
 |          ``constraint_algorithm`` (`ConstraintAlgorithm`)
 |              A ``ConstraintAlgorithm`` which is applied to the ``Universe``.
 |              If an inbuilt ``Solvent`` is selected (e.g. &#39;SPCE&#39;) and
 |              ``constraint_algorithm`` is not passed, the
 |              ``ConstraintAlgorithm`` will default to ``Shake(1e-4, 100)``.
 |
 |      Raises
 |      ------
 |      ValueError
 |          If the ``Universe`` has already been solvated with a different
 |          density.
 |
 |  ----------------------------------------------------------------------
 |  Readonly properties defined here:
 |
 |  atom_type_interactions
 |      Get the atom types and the interactions for each atom type
 |
 |      Returns
 |      -------
 |      dict
 |          ``atom_type:interactions`` pairs where ``atom_type`` is a `int`
 |          specifying the atom type and ``interactions`` is a `list` of
 |          ``Interaction`` objects acting on that ``atom_type``
 |
 |  atom_types
 |      Get the atom types of atoms in the ``Universe``
 |
 |      Returns
 |      -------
 |      list
 |          The atom types in the ``Universe``
 |
 |  atoms
 |      Get a list of the atoms in the Universe
 |
 |      Returns
 |      -------
 |      list
 |          The atoms in the Universe
 |
 |  bonded_interaction_pairs
 |      Get the bonded interactions and the atoms they apply to
 |
 |      Returns
 |      -------
 |      list
 |          The (``interaction``, ``atoms``) pairs in the ``Universe``, where
 |          ``atoms`` is a `tuple` of all ``Atom`` objects for that specific
 |          ``interaction``
 |
 |      Example
 |      -------
 |      For an O Atom with two bonds, one to H1 and one to H2::
 |
 |          &gt;&gt;&gt; print(O.bonded_interaction_pairs)
 |          [(Bond, (H1, O)), (Bond, (H2, O))]
 |
 |  bonded_interactions
 |      Get the bonded interactions in the ``Universe``
 |
 |      Returns
 |      -------
 |      list
 |          The bonded interactions in the ``Universe``
 |
 |  density
 |
 |  element_dict
 |      Get the elements in the ``Universe`` and example ``Atom`` objects for
 |      each element
 |
 |      This is required for MD engines which assign the same potential
 |      parameters for all identical element types.
 |
 |      Returns
 |      -------
 |      dict
 |          ``element:atom pairs``, where ``atom`` is a single ``Atom`` of the
 |          specified ``element``.
 |
 |  element_list
 |      The elements of the atoms in the ``Universe``
 |
 |      Returns
 |      -------
 |      list
 |          The elements in the ``Universe``
 |
 |  force_fields
 |      Get or set the ``ForceField`` acting on the Universe
 |
 |      The available force fields are:
 |      OPLSAA, SPCE, TIP3P, TIP3PFB, SPC
 |
 |      Returns
 |      -------
 |      list
 |          ``ForceField`` that applies to the ``Universe``
 |
 |  interactions
 |      Get the interactions in the ``Universe``
 |
 |      Returns
 |      -------
 |      list
 |          The interactions in the ``Universe``
 |
 |  molecule_list
 |      Get a list of the ``Molecule`` objects in the ``Universe``
 |
 |      Returns
 |      -------
 |      list
 |          The ``Molecule`` objects in the ``Universe``
 |
 |  n_atoms
 |      Get the number of atoms in the ``Universe``
 |
 |      Returns
 |      -------
 |      int
 |          The number of atoms in the ``Universe``
 |
 |  n_bonded
 |      Get the number of bonded interactions in the ``Universe``
 |
 |      Returns
 |      -------
 |      int
 |          The number of bonded interactions in the ``Universe``
 |
 |  n_interactions
 |      Get the number of interactions in the ``Universe``
 |
 |      Returns
 |      -------
 |      int
 |          The number of interactions in the ``Universe``
 |
 |  n_molecules
 |      Get the number of molecules in the ``Universe``
 |
 |      Returns
 |      -------
 |      int
 |          The number of molecules in the ``Universe``
 |
 |  n_nonbonded
 |      Get the number of nonbonded interactions in the ``Universe``
 |
 |      Returns
 |      -------
 |      int
 |          The number of nonbonded interactions in the ``Universe``
 |
 |  nbis_by_atom_type_pairs
 |      Generates a `dict` of all nonbonded interactions possessed by all
 |      combinations of ``atom_type`` pairs in the ``Universe``.
 |
 |      Returns
 |      -------
 |      dict
 |          A `dict` of ``{pair: interactions}`` pairs, where:
 |              - ``pair`` is a `tuple` for a pair of ``atom_types`` in the
 |                ``Universe``
 |              - ``interactions`` is a list of nonbonded interactions that
 |                exist for this ``pair`` of ``atom_types``
 |
 |          Any ``Dispersions`` in ``interactions`` are ones that exist
 |          explicity for this ``pair``, whereas any ``Coulombics`` in
 |          ``interactions`` are ones that exist for either of the
 |          ``atom_types`` in ``pair``.
 |
 |  nonbonded_interactions
 |      Get the nonbonded interactions in the ``Universe``
 |
 |      Returns
 |      -------
 |      list
 |          The nonbonded interactions in the ``Universe``
 |
 |  parameters
 |      Get the parameters of the interactions that exist within the
 |      ``Universe``
 |
 |      Returns
 |      -------
 |      set
 |          The ``Parameters`` objects defined within ``Universe``
 |
 |  solvent_density
 |
 |  structure_list
 |      Get a `list` of all ``StructuralUnit`` objects that exist in the
 |      ``Universe``.  This includes all ``StructuralUnit`` that are a subunit
 |      of another structure belonging to the ``Universe``.
 |
 |
 |      Returns
 |      -------
 |      list
 |          The ``StructuralUnit`` objects in the ``Universe``
 |
 |  volume
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |
 |  dimensions
 |
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |
 |  __abstractmethods__ = frozenset()
 |
 |  __hash__ = None
 |
 |  ----------------------------------------------------------------------
 |  Methods inherited from MDMC.MD.container.AtomContainer:
 |
 |  __getitem__(self, index)
 |      Returns
 |      -------
 |      Atom, list
 |          The atom (or atoms) for the specified index (or slice)
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors inherited from MDMC.MD.container.AtomContainer:
 |
 |  __dict__
 |      dictionary for instance variables (if defined)
 |
 |  __weakref__
 |      list of weak references to the object (if defined)

None
</pre></div></div>
</div>
<p>Similarly, attributes returned also have the units documented. In this case, the unit for <code class="docutils literal notranslate"><span class="pre">velocity</span></code> is a compound unit for the properties <code class="docutils literal notranslate"><span class="pre">LENGTH</span></code> and <code class="docutils literal notranslate"><span class="pre">TIME</span></code> (<code class="docutils literal notranslate"><span class="pre">Ang</span></code> and <code class="docutils literal notranslate"><span class="pre">fs</span></code>):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0. 0. 0.] Ang / fs
</pre></div></div>
</div>
</div>
<div class="section" id="Exceptional-Cases">
<h2>Exceptional Cases<a class="headerlink" href="#Exceptional-Cases" title="Permalink to this headline"></a></h2>
<p>There are some cases where the units expected by an MDMC object are not <code class="docutils literal notranslate"><span class="pre">SYSTEM</span></code> due to external conventions. For example, the <code class="docutils literal notranslate"><span class="pre">SYSTEM</span></code> unit for <code class="docutils literal notranslate"><span class="pre">ANGLE</span></code> is <code class="docutils literal notranslate"><span class="pre">deg</span></code>, but <code class="docutils literal notranslate"><span class="pre">HarmonicPotential</span></code> expects units of <code class="docutils literal notranslate"><span class="pre">kJ</span> <span class="pre">mol^-1</span> <span class="pre">rad^-2</span></code> when used for a <code class="docutils literal notranslate"><span class="pre">BondAngle</span></code>. As before, this information is available from the help function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">MDMC.MD</span> <span class="kn">import</span> <span class="n">HarmonicPotential</span>

<span class="nb">print</span><span class="p">(</span><span class="n">help</span><span class="p">(</span><span class="n">HarmonicPotential</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on class HarmonicPotential in module MDMC.MD.interaction_functions:

class HarmonicPotential(InteractionFunction)
 |  HarmonicPotential(equilibrium_state, potential_strength, **settings)
 |
 |  Harmonic potential for bond stretching, and angular and improper dihedral
 |  vibration, with the form:
 |
 |  .. math::
 |
 |      E = K(r-r_0)^2
 |
 |  As ``HarmonicPotential`` can be used with several different ``Interaction``
 |  types, the ``Interaction`` type must be specified, so that the correct units
 |  can be assigned to the ``equilibrium_state`` and ``potential_strength``
 |  parameters.
 |
 |  Parameters
 |  ----------
 |  equilibrium_state : float
 |      The equilibrium state of the object in either ``Ang`` or ``degrees``,
 |      depending on the ``interaction_type`` passed.
 |  potential_strength : float
 |      The potential strength in units of ``kJ mol^-1 Ang^-2`` (linear) or
 |      ``kJ mol^-1 rad^-2`` (angular/improper), depending on the
 |      ``interaction_type`` passed.
 |  **settings
 |      interaction_type : str
 |          A `str` specifying either ``&#39;bond&#39;``, ``&#39;angle&#39;`` or ``&#39;improper&#39;``.
 |          This assigns the correct units to ``equilibrium_state`` and
 |          ``potential_strength``. This keyword must be passed.
 |
 |  Raises
 |  ------
 |  ValueError
 |      The ``interaction_type`` must be ``&#39;bond&#39;``, ``&#39;angle&#39;``, or
 |      ``&#39;improper&#39;``
 |  TypeError
 |      An ``interaction_type`` of ``&#39;bond&#39;``, ``&#39;angle&#39;``, or ``&#39;improper&#39;``
 |      must be passed
 |
 |  Examples
 |  --------
 |  The following creates a ``HarmonicPotential`` for a ``Bond`` interaction:
 |
 |  .. highlight:: python
 |  .. code-block:: python
 |
 |      hp = HarmonicPotential(1., 4637., interaction_type=&#39;bond&#39;)
 |
 |  The following creates a ``HarmonicPotential`` for a ``BondAngle``
 |  interaction:
 |
 |  .. highlight:: python
 |  .. code-block:: python
 |
 |      hp = HarmonicPotential(109.47, 383., interaction_type=&#39;angle&#39;)
 |
 |  The following creates a ``HarmonicPotential`` for a ``DihedralAngle``
 |  interaction with ``improper==True`` (i.e. an improper dihedral):
 |
 |  .. highlight:: python
 |  .. code-block:: python
 |
 |      hp = HarmonicPotential(180., 20.92, interaction_type=&#39;improper&#39;)
 |
 |  Method resolution order:
 |      HarmonicPotential
 |      InteractionFunction
 |      builtins.object
 |
 |  Methods defined here:
 |
 |  __init__(self, equilibrium_state, potential_strength, **settings)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |
 |  ----------------------------------------------------------------------
 |  Static methods defined here:
 |
 |  __new__(cls, equilibrium_state, potential_strength, **settings)
 |      Create and return a new object.  See help(type) for accurate signature.
 |
 |  ----------------------------------------------------------------------
 |  Methods inherited from InteractionFunction:
 |
 |  __repr__(self)
 |
 |  __str__(self)
 |      Return str(self).
 |
 |  set_parameters_interactions(self, interaction)
 |      Sets the ``parent`` ``Interaction`` for all ``Parameters`` objects
 |
 |      Parameters
 |      ----------
 |      interaction : Interaction
 |          An ``Interaction`` to set as the ``parent`` of all the
 |          ``Parameters``
 |
 |  ----------------------------------------------------------------------
 |  Readonly properties inherited from InteractionFunction:
 |
 |  name
 |      Get the name of the class of the ``InteractionFunction``
 |
 |      Returns
 |      -------
 |      str
 |          The class name
 |
 |  parameters_values
 |      Get the values for all ``Parameters`` objects
 |
 |      Returns
 |      -------
 |      numpy.ndarray
 |          A NumPy ``array`` of values for all ``Parameter``
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors inherited from InteractionFunction:
 |
 |  __dict__
 |      dictionary for instance variables (if defined)
 |
 |  __weakref__
 |      list of weak references to the object (if defined)
 |
 |  parameters
 |      Get or set the ``array`` of ``Parameter`` objects
 |
 |      On setting the ``Parameter`` objects, they are ordered alphabetically by
 |      ``Parameter.name``
 |
 |      Returns
 |      -------
 |      numpy.ndarray
 |          A NumPy ``array`` of ``Parameter``

None
</pre></div></div>
</div>
<p>Another example is <code class="docutils literal notranslate"><span class="pre">energy_resolution</span></code> being expected in units of <code class="docutils literal notranslate"><span class="pre">ueV</span></code> rather than the <code class="docutils literal notranslate"><span class="pre">meV</span></code> used for <code class="docutils literal notranslate"><span class="pre">ENERGY_TRANSFER</span></code> elsewhere:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">MDMC.control</span> <span class="kn">import</span> <span class="n">Control</span>

<span class="nb">print</span><span class="p">(</span><span class="n">help</span><span class="p">(</span><span class="n">Control</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on class Control in module MDMC.control.control:

class Control(builtins.object)
 |  Control(simulation: MDMC.MD.simulation.Simulation, exp_datasets: List[dict], fit_parameters: MDMC.MD.parameters.Parameters, MC_norm: float = 1.0, minimizer_type: str = &#39;MMC&#39;, FoM_options: dict = None, reset_config: bool = True, MD_steps: int = None, equilibration_steps: int = 0, convergence_tol: float = 1e-05, min_refinement_steps: int = 2, max_parameter_change: float = 0.01, verbose: int = 0, **settings: dict)
 |
 |  Controls the MDMC refinement
 |
 |  Parameters
 |  ----------
 |  simulation : Simulation
 |      Performs a simulation for a given set of potential ``Parameter``
 |      objects.
 |  exp_datasets : list of dicts
 |      Each `dict` represents an experimental dataset, containing the
 |      following keys:
 |        - ``file_name`` (`str`) the file name
 |        - ``type`` (`str`) the type of observable
 |        - ``reader`` (`str`) the reader required for the file
 |        - ``weighting`` (`float`) the weighting of the dataset to be used in
 |          the Figure of Merit calculation
 |        - ``resolution`` : (`dict`, but can be `str`, `float`, or None)
 |          Should be a one-line dict of format {&#39;file&#39; : str} or {key : float}
 |          if {&#39;file&#39; : str}, the str should be a file in
 |          the same format as ``file_name`` containing results of a vanadium
 |          sample which is used to determine instrument energy resolution for
 |          this dataset.
 |          If {key : float}, the key should be the type of resolution function.
 |          allowed types are &#39;gaussian&#39; and &#39;lorentzian&#39;
 |          Can also be &#39;lazily&#39; given as just a `str` or `float`.
 |          If just a string is given, it is assumed to be a filename.
 |          If just a float is given, it is assumed to be Gaussian.
 |          The float should be the instrument energy resolution as the FWHM in ``ueV`` (micro eV).
 |          If you have already accounted for instrument resolution in your dataset, this field can
 |          be set to None, and resolution application will be skipped. This must be done explicitly.
 |        - ``rescale_factor`` (`float`, optional, defaults to `1.`) applied to
 |          the experimental data when calculating the FoM to ensure it is on
 |          the same scale as the calculated observable
 |        - ``auto_scale`` (`bool`, optional, defaults to `False`) set the
 |          ``rescale_factor`` automatically to minimise the FoM, if both
 |          ``rescale_factor`` and ``auto_scale`` are provided then a warning
 |          is printed and ``auto_scale`` takes precedence
 |        - ``use_FFT`` (`bool`, optional, defaults to `True`) whether to use
 |          Fast Fourier Transforms in the calculation of dependent variables.
 |          FFT speeds up calculation but places restrictions on spacing in the
 |          independent variable domain(s). This option may not be supported
 |          for all ``Observable``s
 |      Note that the default (and preferred) behaviour of the scaling settings requires that the
 |      dataset provided has been properly scaled and normalised for the refinement process.
 |      Arbitrary or automatic rescaling should be undertaken with care, as it does not take into
 |      account any physical aspects of scaling the data, such as the presence or absence of
 |      background events from peaks outside its range.
 |  fit_parameters : Parameters, list of Parameter
 |      All parameters which will be refined. Note that any ``Parameter`` that is ``fixed``,
 |      ``tied`` or equal to 0 will not be passed to the minimizer as these cannot be refined.
 |      Those with ``constraints`` set are still passed.
 |  MC_norm : float, optional
 |      Determines the accept/reject ratio of the MC. Default is 1.
 |  minimizer_type : str, optional
 |      The ``Minimizer`` type. Default is &#39;MMC&#39;.
 |  FoM_options : dict of {str : str}, optional
 |      Defines the details of the ``FigureOfMeritCalculator`` to use. Default is `None`, in which
 |      case the first option for each of the following keys is used:
 |        - ``errors`` {&#39;exp&#39;, &#39;none&#39;} Whether to weight the differences between MD and
 |          experimental data with the experimental error or not (errors from MD are not currently
 |          supported).
 |        - ``norm`` {&#39;data_points&#39;, &#39;dof&#39;, &#39;none&#39;} How to normalise the FoM, either by the total
 |          number of data_points (n), the degrees of freedom (n - m, where m is the number of
 |          parameters being varied), or not at all.
 |  reset_config : bool, optional
 |      Determines if the configuration is reset to the end of the last accepted
 |      state. Default is `True`.
 |  max_parameter_change : float, optional
 |      Maximum factor by which a Parameter can change each step of the
 |      refinement. Defaults to `0.01`
 |  MD_steps : int, optional
 |      Number of molecular dynamics steps for each step of the refinement.
 |      When not provided, the minimum number of steps needed for successful
 |      calculation of the observables is used. If provided, the actual number
 |      of steps may be reduced to prevent running MD that won&#39;t be used when
 |      calculting dependent variables. Default is `None`.
 |  equilibration_steps : int, optional
 |      Number of molecular dynamics steps used to equilibrate the ``Universe`` in between each
 |      refinement step. When changes to the ``Parameters`` are small, this equilibration can be
 |      much shorter than the equilibration needed before starting the refinement process, but in
 |      general will vary depending on the details of the ``Universe`` and ``Parameters``. Default
 |      is 0.
 |  convergence_tol : float, optional
 |      The relative tolerance used to determine if a refinement has converged. If the Figure of Merit and all
 |      ``Parameters`` change less than this tolerance between two accepted refinement steps the refinement stops.
 |      Default value is 1e-5.
 |  min_refinement_steps : int, optional
 |      The minimum number of refinement steps before the refinement process can stop if all parameters and the
 |      Figure of Merit have converged. Default value is 2.
 |  verbose: int, optional
 |      If 2, timings are printed for every step of the refinement. If 1,
 |      timings are printed at the end of the refinement. If 0, no timings
 |      are printed. In all cases information about the FoM and parameter
 |      values will still be printed. Default is 0.
 |
 |  Example
 |  -------
 |  An example of an exp_dataset list is::
 |
 |      [{&#39;file_name&#39;:data.LAMP_SQW_FILE,
 |        &#39;type&#39;:&#39;SQw&#39;,
 |        &#39;reader&#39;:&#39;LAMPSQw&#39;,
 |        &#39;weight&#39;:1.,
 |        &#39;resolution&#39;:{&#39;file&#39;:data.LAMP_SQW_VAN_FILE}
 |        &#39;rescale_factor&#39;:0.5},
 |       {&#39;file_name:data.ANOTHER_FILE&#39;,
 |        &#39;type&#39;:&#39;FQt&#39;,
 |        &#39;reader&#39;:&#39;GENERIC_READER&#39;,
 |        &#39;weight&#39;:0.5,
 |        &#39;resolution&#39;:{&#39;gaussian&#39;:2.35}
 |        &#39;auto_scale&#39;:True}]
 |
 |  Attributes
 |  ----------
 |  simulation : Simulation
 |      The ``Simulation`` on which is used to perform the refinement
 |  exp_datasets : `list of dicts`
 |      One `dict` per experimental dataset used for the refinement
 |  fit_parameters : Parameters
 |      All ``Parameter`` objects which will be refined
 |  minimizer : Minimizer
 |      Refines the potential parameters.
 |  observable_pairs : `list` of ``ObservablePairs``
 |      Experimental observable/MD observable pairs which are used to calculate
 |      the Figure of Merit
 |  FoM_calculator : FigureOfMeritCalculator
 |      Calculates the FoM `float` from the ``observable_pairs``.
 |  MD_steps : `int`
 |      Number of molecular dynamics steps for each step of the refinement
 |
 |  Methods defined here:
 |
 |  __init__(self, simulation: MDMC.MD.simulation.Simulation, exp_datasets: List[dict], fit_parameters: MDMC.MD.parameters.Parameters, MC_norm: float = 1.0, minimizer_type: str = &#39;MMC&#39;, FoM_options: dict = None, reset_config: bool = True, MD_steps: int = None, equilibration_steps: int = 0, convergence_tol: float = 1e-05, min_refinement_steps: int = 2, max_parameter_change: float = 0.01, verbose: int = 0, **settings: dict)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |
 |  __repr__(self)
 |
 |  __str__(self)
 |      Return str(self).
 |
 |  equilibrate(self)
 |      Run molecular dynamics to equilibrate the ``Universe``.
 |
 |  refine(self, n_steps: int)
 |      Refines the specified potential parameters
 |
 |      Parameters
 |      ----------
 |      n_steps : int
 |          maximum number of steps for the refinement
 |
 |      Examples
 |      --------
 |      Perform a refinement with a maximum of 100 steps:
 |
 |          .. highlight:: python
 |          .. code-block:: python
 |
 |          control.refine(100)
 |
 |  step(self)
 |      Do a full step: generate and run MD to calculate FoM for existing
 |      parameters, iterate parameters a step forward and reset MD (phasespace)
 |      if previous step was rejected and reset_config = true
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |
 |  __dict__
 |      dictionary for instance variables (if defined)
 |
 |  __weakref__
 |      list of weak references to the object (if defined)

None
</pre></div></div>
</div>
</div>
<div class="section" id="Converting-Units">
<h2>Converting Units<a class="headerlink" href="#Converting-Units" title="Permalink to this headline"></a></h2>
<p>The conversion factor required to get to MDMC <code class="docutils literal notranslate"><span class="pre">SYSTEM</span></code> units from a general unit can be accessed by creating a new <code class="docutils literal notranslate"><span class="pre">Unit</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">general_unit</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;kcal / Ang mol&#39;</span><span class="p">)</span>
<span class="n">SYSTEM_unit</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">SYSTEM</span><span class="p">[</span><span class="n">general_unit</span><span class="o">.</span><span class="n">physical_property</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;To convert from `</span><span class="si">{0}</span><span class="s1">` to `</span><span class="si">{1}</span><span class="s1">`, multiply by a factor of </span><span class="si">{2}</span><span class="s1">&#39;</span>
      <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">general_unit</span><span class="p">,</span> <span class="n">SYSTEM_unit</span><span class="p">,</span> <span class="n">general_unit</span><span class="o">.</span><span class="n">conversion_factor</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;To convert from `</span><span class="si">{1}</span><span class="s1">` to `</span><span class="si">{0}</span><span class="s1">`, divide by a factor of </span><span class="si">{2}</span><span class="s1">&#39;</span>
      <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">general_unit</span><span class="p">,</span> <span class="n">SYSTEM_unit</span><span class="p">,</span> <span class="n">general_unit</span><span class="o">.</span><span class="n">conversion_factor</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
To convert from `kcal / Ang mol` to `kJ / Ang mol`, multiply by a factor of 4.184
To convert from `kJ / Ang mol` to `kcal / Ang mol`, divide by a factor of 4.184
</pre></div></div>
</div>
<p>For example, to create an <code class="docutils literal notranslate"><span class="pre">Atom</span></code> with a position in <code class="docutils literal notranslate"><span class="pre">nm</span></code> rather <code class="docutils literal notranslate"><span class="pre">Ang</span></code>, then access that value in <code class="docutils literal notranslate"><span class="pre">m</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">position_nm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,])</span>
<span class="n">position_ang</span> <span class="o">=</span> <span class="n">position_nm</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conversion_factor</span>
<span class="n">atom</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position_ang</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Atom position in `m` is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">position</span><span class="p">)</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conversion_factor</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Atom position in `m` is [1.e-09 1.e-09 1.e-09]
</pre></div></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="read-configurations.html" class="btn btn-neutral float-left" title="Reading atoms from configuration files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="applying-a-forcefield.html" class="btn btn-neutral float-right" title="Applying a ForceField" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>