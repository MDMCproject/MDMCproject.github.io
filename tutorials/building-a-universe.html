

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building an MDMC Universe &mdash; MDMC 0.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reading atoms from configuration files" href="read-configurations.html" />
    <link rel="prev" title="4. Parameter Refinement" href="../pages/parameter-refinement.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MDMC
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/simulations.html">3. Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/parameter-refinement.html">4. Parameter Refinement</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Building an MDMC Universe</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Create-an-atomic-configuration">Create an atomic configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Create-an-atom">Create an atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Atom-type">Atom type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Create-bonded-interactions">Create bonded interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Bond"><code class="docutils literal notranslate"><span class="pre">Bond</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#BondAngle"><code class="docutils literal notranslate"><span class="pre">BondAngle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DihedralAngle"><code class="docutils literal notranslate"><span class="pre">DihedralAngle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Copying-bonded-atoms">Copying bonded atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Create-a-molecule">Create a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Creating-molecules-using-configuration-files">Creating molecules using configuration files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Add-structural-units-to-a-universe">Add structural units to a universe</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Create-non-bonded-interactions">Create non-bonded interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Applying-a-ForceField">Applying a <code class="docutils literal notranslate"><span class="pre">ForceField</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Adding-kspace-solvers-to-a-universe">Adding kspace solvers to a universe</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Adding-constraint-algorithms-to-a-universe">Adding constraint algorithms to a universe</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Example-Universe-filled-with-SPCE-water">Example Universe filled with SPCE water</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="read-configurations.html">Reading atoms from configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="applying-a-forcefield.html">Applying a <code class="docutils literal notranslate"><span class="pre">ForceField</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="solvating-a-universe.html">Solvating an MDMC Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="molecular-visualization.html">Molecular Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="running-a-simulation.html">Running a Simulation in MDMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="selecting-fitting-parameters.html">Selecting Fitting Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="running-a-refinement.html">Running a Refinement</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/common.html">Common</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/control.html">Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/gui.html">gui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/md.html">MD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/readers.html">readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/refinement.html">refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/modules/trajectory_analysis.html">trajectory_analysis</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MDMC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Building an MDMC Universe</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/building-a-universe.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Building-an-MDMC-Universe">
<h1>Building an MDMC Universe<a class="headerlink" href="#Building-an-MDMC-Universe" title="Permalink to this headline">¶</a></h1>
<p>An MDMC simulation requires a configuration and a topology defined within a <code class="docutils literal notranslate"><span class="pre">Universe</span></code> object. Although MDMC is somewhat flexible with regards to the order in which these are created, a suggested approach is as follows: ## Create the Universe MDMC currently only supports orthorhombic boxed Universes; the <code class="docutils literal notranslate"><span class="pre">dimensions</span></code> must be specified when creating (initialising) the <code class="docutils literal notranslate"><span class="pre">Universe</span></code> object:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import the Universe class</span>
<span class="kn">from</span> <span class="nn">MDMC.MD.simulation</span> <span class="k">import</span> <span class="n">Universe</span>
<span class="c1"># Initialise a Universe with dimensions in Ang</span>
<span class="n">universe</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>To create a cubic <code class="docutils literal notranslate"><span class="pre">Universe</span></code>, only a single float needs to be specified for the <code class="docutils literal notranslate"><span class="pre">dimensions</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">universe</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Create-an-atomic-configuration">
<h2>Create an atomic configuration<a class="headerlink" href="#Create-an-atomic-configuration" title="Permalink to this headline">¶</a></h2>
<p>Configurations can either be specified by the user or read from a CIF file.</p>
<div class="section" id="Create-an-atom">
<h3>Create an atom<a class="headerlink" href="#Create-an-atom" title="Permalink to this headline">¶</a></h3>
<p>Each atom is specified using an <code class="docutils literal notranslate"><span class="pre">Atom</span></code> object, which possesses (amongst other things) a <code class="docutils literal notranslate"><span class="pre">position</span></code>, <code class="docutils literal notranslate"><span class="pre">velocity</span></code>, <code class="docutils literal notranslate"><span class="pre">element</span></code>, <code class="docutils literal notranslate"><span class="pre">mass</span></code>, <code class="docutils literal notranslate"><span class="pre">charge</span></code>, and <code class="docutils literal notranslate"><span class="pre">atom_type</span></code>. At a minimum the <code class="docutils literal notranslate"><span class="pre">element</span></code> must be specified when creating an <code class="docutils literal notranslate"><span class="pre">Atom</span></code> object:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import the Atom class</span>
<span class="kn">from</span> <span class="nn">MDMC.MD.structural_units</span> <span class="k">import</span> <span class="n">Atom</span>
<span class="c1"># Create a hydrogen atom</span>
<span class="n">H1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This will create a Hydrogen atom with mass determined from an elemental lookup table, position and velocity of (0., 0., 0.) and no charge or atom type. Atoms can also be created by copying another atom and passing the position of the new atom:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">H2</span> <span class="o">=</span> <span class="n">H1</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The copied atom will have identical properties to the original attribute, except with a different ID (which is unique for all structural units) and a different position. This includes interactions, which will applying to the copied atom in the same way as the original atom e.g. if H1 is bonded to an atom O, H2 will also be bonded to atom O. An example of this is shown in the section <strong>‘Create bonded interactions’</strong>.</p>
</div>
<div class="section" id="Atom-type">
<h3>Atom type<a class="headerlink" href="#Atom-type" title="Permalink to this headline">¶</a></h3>
<p>Each atom has an atom_type, which is used for applying non-bonded interactions between atoms; all atoms of the same atom_type will have the same non-bonded interactions applying to them. The atom_type can be specified when the atom is created:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">O1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">],</span> <span class="n">atom_type</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># and to add the created atom to universe do</span>
<span class="n">universe</span><span class="o">.</span><span class="n">add_structural_unit</span><span class="p">(</span><span class="n">O1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Alternatively, the atom_type can be inferred by MDMC. This occurs when an atom with no defined atom_type is added to a Universe:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">O2</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">9.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">])</span>
<span class="n">universe</span><span class="o">.</span><span class="n">add_structural_unit</span><span class="p">(</span><span class="n">O2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Assuming no other atoms have been added to the universe, this sets <code class="docutils literal notranslate"><span class="pre">O2.atom_type</span></code> equal to 1. MDMC infers the atom_type of each atom based on its element and its interactions: all atoms with the same element and the same interactions <strong>when they are added to the universe</strong> will have the same atom_type. <strong>Once an atom’s atom_type is set, it is immutable i.e. it cannot be changed.</strong> It is recommended that either all atom types are specified when atoms are created or none are (i.e. either MDMC is
left to infer and assign all atom types or no atom types. Only specifying some atom types could result in unexpected behaviour; if it is absolutely necessary then ensure that all atoms with specified atom types are added to the universe first).</p>
<p>To see what atoms have been added to the universe:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">universe</span><span class="o">.</span><span class="n">structure_list</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;Atom
  {name: &#39;O&#39;,
   ID: 3,
   element: &#39;O&#39;,
   position: UnitNDArray([8., 8., 8.]) Ang,
   velocity: UnitNDArray([0., 0., 0.]) Ang / fs}&gt;, &lt;Atom
  {name: &#39;O&#39;,
   ID: 4,
   element: &#39;O&#39;,
   position: UnitNDArray([9., 9., 9.]) Ang,
   velocity: UnitNDArray([0., 0., 0.]) Ang / fs}&gt;]
</pre></div></div>
</div>
<p>You can see other attributes of the universe (or any other MDMC containers) with:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">universe</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on Universe in module MDMC.MD.simulation object:

class Universe(MDMC.MD.container.AtomContainer)
 |  Class where configuration and topology are defined
 |
 |  Parameters
 |  ----------
 |  dimensions : np.array, list, float
 |      Dimensions of the Universe, in units of Ang. A float can be used for a
 |      cubic universe.
 |  shape : enum
 |      Member of the Shape enum.
 |  force_field : ForceField
 |      A force field to apply to the Universe. The force fields available are:
 |      OPLSAA, SPCE, SPC
 |  structures : list
 |      Structures contained in the Universe.
 |
 |  **settings
 |      kspace_solver : KSpaceSolver
 |          The k-space solver to be used for both electrostatic and dispersive
 |          interactions. If this is passed then no electrostatic_solver or
 |          dispersive_solver may be passed.
 |      electrostatic_solver : KSpaceSolver
 |          The k-space solver to be used for electrostatic interactions.
 |      dispersive_solver : KSpaceSolver
 |          The k-space solver to be used for dispersive interactions.
 |      constraint_algorithm : ConstraintAlgorithm
 |          The constraint algorithm which will be applied to constrained
 |          BondedInteractions.
 |
 |  Attributes
 |  ----------
 |  shape : enum
 |      Member of the Shape enum.
 |  kspace_solver : KSpaceSolver
 |      The k-space solver to be used for both electrostatic and dispersive
 |      interactions.
 |  electrostatic_solver : KSpaceSolver
 |      The k-space solver to be used for electrostatic interactions.
 |  dispersive_solver : KSpaceSolver
 |      The k-space solver to be used for dispersive interactions.
 |  constraint_algorithm : ConstraintAlgorithm
 |      The constraint algorithm which will be applied to constrained
 |      BondedInteractions.
 |
 |  Method resolution order:
 |      Universe
 |      MDMC.MD.container.AtomContainer
 |      abc.ABC
 |      builtins.object
 |
 |  Methods defined here:
 |
 |  __init__(self, dimensions, shape=&lt;Shape.cubic: 1&gt;, force_field=None, structures=None, **settings)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |
 |  add_bonded_interaction_pairs(self, *bonded_interaction_pairs)
 |      Adds one or more interaction pairs to the Universe
 |
 |      Parameters
 |      ----------
 |      *bonded_interaction_pairs
 |          one or more (interaction, atoms) pairs, where atoms is a tuple of
 |          all atoms for that specific bonded interaction
 |
 |  add_force_field(self, force_field, *interactions, **settings)
 |      Adds a force field to the specified interactions.  If no interactions
 |      are passed, the force field is applied to all interactions in the
 |      Universe.
 |
 |      Parameters
 |      ----------
 |      force_field : str
 |          The ForceField to parameterize interactions (if provided), or all
 |          the interactions in the universe. The available force fields are:
 |          OPLSAA, SPCE, SPC
 |      *interactions
 |          Interactions to parameterize with the force field
 |      **settings
 |          add_dispersions : bool or list of Atoms
 |              If True, a Dispersion interaction will be added to all atoms in
 |              the Universe. If a list of Atom objects is provided, the
 |              Dispersion will be added to these instead. Any added Dispersion
 |              interactions (and any previously defined) will then be
 |              parametrized by the ForceField. The Dispersion interactions
 |              added will only be like-like. By default, no Dispersion
 |              interactions are added.
 |
 |  add_nonbonded_interaction(self, *nonbonded_interactions)
 |      Adds one or more nonbonded interactions to the Universe
 |
 |      Parameters
 |      ----------
 |      *nonbonded_interactions
 |          Nonbonded interactions to be added to the Universe
 |
 |  add_structural_unit(self, structural_unit, force_field=None, center=False)
 |      Adds a single structural unit to the universe, with optional force field
 |      applying only to that structural unit
 |
 |      Parameters
 |      ----------
 |      structural_unit : StructuralUnit
 |          The structural unit to be added to the Universe
 |      force_field : str, optional
 |          The force field to be applied to the structural unit. The available
 |          force fields are:
 |          OPLSAA, SPCE, SPC
 |      center : bool, optional
 |          Whether to center to `structural_unit` within the Universe as it
 |          is added
 |
 |  fill(self, structural_unit, force_field=None, **settings)
 |      A liquid-like filling of the Universe independent of existing atoms
 |
 |      Adds copies of structural_unit to existing configuration until Universe
 |      is full.  As exclusion region is defined by the size of a bounding
 |      sphere, this method is most suitable for atoms or molecules with
 |      approximately equal dimensions.
 |
 |      CURRENT APPROACH RESULTS IN NUMBER DENSITY DIFFERENT TO WHAT IS
 |      SPECIFIED DEPENDING ON HOW CLOSE CUBE ROOT OF N_MOLECULES IS TO AN INT.
 |
 |      Parameters
 |      ----------
 |      structural_unit : StructuralUnit
 |          The structural unit with which to fill the Universe
 |      force_field : str
 |          Applies a force field to the Universe. The available force fields
 |          are:
 |          OPLSAA, SPCE, SPC
 |      **settings
 |          num_density : float
 |              Non-negative float specifying the number density of the
 |              structural unit, in units of structural units Ang ^ -3
 |          num_struc_units : int
 |              Non-negative int specifying the number of passed structural
 |              units that the universe should be filled with, regardless of
 |              universe dimensions.
 |
 |      Raises
 |      ------
 |      ValueError
 |          If both num_density and num_struc_units are passed
 |      ValueError
 |          If neither num_density or num_struc_units are passed
 |
 |  solvate(self, density, tolerance=1.0, solvent=&#39;SPCE&#39;, **settings)
 |      Fills the universe with solvent molecules according to pre-defined
 |      coordinates.
 |
 |      Parameters
 |      ----------
 |      density : float
 |          The desired density of the solvent that solvates the universe,
 |          in units of amu Ang ^ -3
 |      tolerance : float, optional
 |          The +/- percentage tolerance of the density to be achieved.
 |          The default is 1 %. Tolerances of less than 1 % are at risk
 |          of not converging.
 |      solvent : str, optional
 |          A str specifying an inbuilt solvent from the following:
 |          SPC, SPCE.
 |          The default is &#39;SPCE&#39;.
 |      **settings
 |          constraint_algorithm : ConstraintAlgorithm
 |              A ConstraintAlgorithm which is applied to the Universe.  If an
 |              inbuilt solvent is selected (e.g. &#39;SPCE&#39;) and
 |              constraint_algorithm is not passed, the ConstraintAlgorithm will
 |              default to Shake(1e-4, 100).
 |
 |      Raises
 |      ------
 |      ValueError
 |          If the universe has already been solvated with a different density.
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |
 |  atom_list
 |      Get a list of the atoms in the Universe
 |
 |      Returns
 |      -------
 |      list
 |          The atoms in the Universe
 |
 |  atom_type_interactions
 |      Get the atom types and the interactions for each atom type
 |
 |      Returns
 |      -------
 |      dict
 |          atom_type:interactions pairs where atom_type is a int specifying the
 |          atom type and interactions is a list of interactions acting on that
 |          atom_type
 |
 |  atom_types
 |      Get the atom types of atoms in the Universe
 |
 |      Returns
 |      -------
 |      list
 |          The atom types in the Universe
 |
 |  bonded_interaction_pairs
 |      Get the bonded interactions and the atoms they apply to
 |
 |      Returns
 |      -------
 |      list
 |          The (interaction, atoms) pairs in the Universe, where atoms is a
 |          tuple of all atoms for that specific interaction
 |
 |      Example
 |      -------
 |      For an O Atom with two bonds, one to H1 and one to H2::
 |
 |          &gt;&gt;&gt; print(O.bonded_interaction_pairs)
 |          [(Bond, (H1, O)), (Bond, (H2, O))]
 |
 |  bonded_interactions
 |      Get the bonded interactions in the Universe
 |
 |      Returns
 |      -------
 |      list
 |          The bonded interactions in the Universe
 |
 |  density
 |
 |  dimensions
 |
 |  element_dict
 |      Get the elements in the Universe and examples atoms for each element
 |
 |      This is required for MD engines which assign the same potential
 |      parameters for all identical element types.
 |
 |      Returns
 |      -------
 |      dict
 |          element:atom pairs, where atom is a single atom of the specified
 |          element.
 |
 |  element_list
 |      The elements of the atoms in the Universe.
 |
 |      Returns
 |      -------
 |      list
 |          The elements in the Universe.
 |
 |  force_fields
 |      Get or set the force fields acting on the Universe
 |
 |      The available force fields are:
 |      OPLSAA, SPCE, SPC
 |
 |      Returns
 |      -------
 |      list
 |          Force fields that apply to the Universe
 |
 |  interactions
 |      Get the interactions in the Universe
 |
 |      Returns
 |      -------
 |      list
 |          The interactions in the Universe
 |
 |  molecule_list
 |      Get a list of the molecules in the Universe
 |
 |      Returns
 |      -------
 |      list
 |          The molecules in the Universe
 |
 |  nbis_by_atom_type_pairs
 |      Generates a dictionary of all nonbonded interactions possessed by all
 |      combinations of atom_type pairs in the universe.
 |
 |      Returns
 |      -------
 |      pairs_interactions : dict of {tuple: list} pairs
 |          A dictionary of {pair: interactions} pairs, where:
 |              - pair is a tuple for a pair of atom types in the universe,
 |              - interactions is a list of nonbonded interactions that exist
 |                for this pair of atom types.
 |
 |          Any Dispersions in interactions are ones that exist explicity
 |          for this pair, whereas any Coulombics in interactions are ones
 |          that exist for either of the atom types in pair.
 |
 |  nonbonded_interactions
 |      Get the nonbonded interactions in the Universe
 |
 |      Returns
 |      -------
 |      list
 |          The nonbonded interactions in the Universe
 |
 |  parameters
 |      Get the parameters of the interactions that exist within the Universe
 |
 |      Returns
 |      -------
 |      set
 |          The parameters in the Universe
 |
 |  solvent_density
 |
 |  structure_list
 |      Get a list of all structural units that exist in the Universe.  This
 |      includes all structural units that are a subunit of another structure
 |      belonging to the universe.
 |
 |
 |      Returns
 |      -------
 |      list
 |          The structural units in the Universe
 |
 |  volume
 |
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |
 |  __abstractmethods__ = frozenset()
 |
 |  ----------------------------------------------------------------------
 |  Methods inherited from MDMC.MD.container.AtomContainer:
 |
 |  __getitem__(self, index)
 |      Returns
 |      -------
 |      Atom, list
 |          The atom (or atoms) for the specified index (or slice)
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors inherited from abc.ABC:
 |
 |  __dict__
 |      dictionary for instance variables (if defined)
 |
 |  __weakref__
 |      list of weak references to the object (if defined)

</pre></div></div>
</div>
<p>The same applies for methods, for example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">universe</span><span class="o">.</span><span class="n">add_structural_unit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method add_structural_unit in module MDMC.MD.simulation:

add_structural_unit(structural_unit, force_field=None, center=False) method of MDMC.MD.simulation.Universe instance
    Adds a single structural unit to the universe, with optional force field
    applying only to that structural unit

    Parameters
    ----------
    structural_unit : StructuralUnit
        The structural unit to be added to the Universe
    force_field : str, optional
        The force field to be applied to the structural unit. The available
        force fields are:
        OPLSAA, SPCE, SPC
    center : bool, optional
        Whether to center to `structural_unit` within the Universe as it
        is added

</pre></div></div>
</div>
</div>
<div class="section" id="Create-bonded-interactions">
<h3>Create bonded interactions<a class="headerlink" href="#Create-bonded-interactions" title="Permalink to this headline">¶</a></h3>
<p>There are three bonded interaction types exist within MDMC: <code class="docutils literal notranslate"><span class="pre">Bond</span></code>, <code class="docutils literal notranslate"><span class="pre">BondAngle</span></code> and <code class="docutils literal notranslate"><span class="pre">Dihedral</span></code>. Each <code class="docutils literal notranslate"><span class="pre">Interaction</span></code> must have an <code class="docutils literal notranslate"><span class="pre">InteractionFunction</span></code> which describes the <code class="docutils literal notranslate"><span class="pre">Interaction</span></code>.</p>
</div>
<div class="section" id="Bond">
<h3><code class="docutils literal notranslate"><span class="pre">Bond</span></code><a class="headerlink" href="#Bond" title="Permalink to this headline">¶</a></h3>
<p>Below this is demonstrated where a <code class="docutils literal notranslate"><span class="pre">Bond</span></code> with a <code class="docutils literal notranslate"><span class="pre">HarmonicPotential</span></code> function is created.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import Bond and HarmonicPotential</span>
<span class="kn">from</span> <span class="nn">MDMC.MD.structural_units</span> <span class="k">import</span> <span class="n">Bond</span>
<span class="kn">from</span> <span class="nn">MDMC.MD.interaction_functions</span> <span class="k">import</span> <span class="n">HarmonicPotential</span>
<span class="c1"># Create a Bond with a HarmonicPotential</span>
<span class="c1"># The first argument in the HarmonicPotential is the equilibrium state and the second is the potential strength</span>
<span class="n">HH_bond</span> <span class="o">=</span> <span class="n">Bond</span><span class="p">(</span><span class="n">H1</span><span class="p">,</span> <span class="n">H2</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">HarmonicPotential</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="n">interaction_type</span><span class="o">=</span><span class="s1">&#39;bond&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>To see which units are supported:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">MDMC.common.units</span> <span class="k">import</span> <span class="n">SYSTEM</span>
<span class="n">SYSTEM</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;LENGTH&#39;: &#39;Ang&#39;,
 &#39;TIME&#39;: &#39;fs&#39;,
 &#39;MASS&#39;: &#39;amu&#39;,
 &#39;CHARGE&#39;: &#39;e&#39;,
 &#39;ANGLE&#39;: &#39;deg&#39;,
 &#39;TEMPERATURE&#39;: &#39;K&#39;,
 &#39;ENERGY&#39;: &#39;kJ / mol&#39;,
 &#39;FORCE&#39;: &#39;kJ / Ang mol&#39;,
 &#39;PRESSURE&#39;: &#39;Pa&#39;,
 &#39;ENERGY_TRANSFER&#39;: &#39;meV&#39;,
 &#39;ARBITRARY&#39;: &#39;arb&#39;}
</pre></div></div>
</div>
</div>
<div class="section" id="BondAngle">
<h3><code class="docutils literal notranslate"><span class="pre">BondAngle</span></code><a class="headerlink" href="#BondAngle" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">BondAngle</span></code> is created in the same manner except it requires a minimum of three atoms. The central atom should be the the 2nd atom. For example, a water molecule would have:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">MDMC.MD.structural_units</span> <span class="k">import</span> <span class="n">BondAngle</span>

<span class="n">H1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
<span class="n">H2</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.63298</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
<span class="n">O</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.81649</span><span class="p">,</span> <span class="mf">0.57736</span><span class="p">])</span>
<span class="n">HOH_angle</span> <span class="o">=</span> <span class="n">BondAngle</span><span class="p">(</span><span class="n">H1</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">H2</span><span class="p">)</span>

<span class="c1"># The following is equivalent</span>
<span class="n">HOH_angle</span> <span class="o">=</span> <span class="n">BondAngle</span><span class="p">(</span><span class="n">H2</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">H1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Currently <code class="docutils literal notranslate"><span class="pre">HarmonicPotential</span></code> is the only <code class="docutils literal notranslate"><span class="pre">InteractionFunction</span></code> that can be applied to either <code class="docutils literal notranslate"><span class="pre">Bond</span></code> or <code class="docutils literal notranslate"><span class="pre">BondAngle</span></code>.</p>
<p>All <code class="docutils literal notranslate"><span class="pre">Bond</span></code> and <code class="docutils literal notranslate"><span class="pre">BondAngle</span></code> can be constrained; this can either be set when creating the <code class="docutils literal notranslate"><span class="pre">Bond</span></code> (or <code class="docutils literal notranslate"><span class="pre">BondAngle</span></code>) or afterwards:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">HH_bond</span><span class="o">.</span><span class="n">constrained</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">HOH_angle</span> <span class="o">=</span> <span class="n">BondAngle</span><span class="p">(</span><span class="n">H1</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">H2</span><span class="p">,</span> <span class="n">constrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For a constraint to applied during a simulation, the <code class="docutils literal notranslate"><span class="pre">Universe</span></code> must have a <code class="docutils literal notranslate"><span class="pre">ConstraintAlgorithm</span></code>.</p>
</div>
<div class="section" id="DihedralAngle">
<h3><code class="docutils literal notranslate"><span class="pre">DihedralAngle</span></code><a class="headerlink" href="#DihedralAngle" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">DihedralAngle</span></code> is also created in the same manner, except it requires four atoms. A <code class="docutils literal notranslate"><span class="pre">DihedralAngle</span></code> can be proper or improper, as specified by <code class="docutils literal notranslate"><span class="pre">DihedralAngle.improper</span></code>. By default a <code class="docutils literal notranslate"><span class="pre">DihedralAngle</span></code> is proper.</p>
<p>The atoms in a proper <code class="docutils literal notranslate"><span class="pre">DihedralAngle</span></code> must be specified so that the 2nd and 3rd atoms are the central two atoms:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">MDMC.MD.structural_units</span> <span class="k">import</span> <span class="n">DihedralAngle</span>

<span class="n">C1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">5.12033922</span><span class="p">,</span> <span class="mf">4.63847287</span><span class="p">,</span> <span class="mf">4.94075943</span><span class="p">])</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">5.12991894</span><span class="p">,</span> <span class="mf">3.78609704</span><span class="p">,</span> <span class="mf">3.79996577</span><span class="p">])</span>
<span class="n">C2</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">4.91462725</span><span class="p">,</span> <span class="mf">4.08992816</span><span class="p">,</span> <span class="mf">2.5091264</span><span class="p">])</span>
<span class="n">O</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">4.67405373</span><span class="p">,</span> <span class="mf">5.24130678</span><span class="p">,</span> <span class="mf">2.1180462</span><span class="p">])</span>
<span class="n">proper</span> <span class="o">=</span> <span class="n">DihedralAngle</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">C1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">O</span><span class="p">])</span>

<span class="c1"># For a proper DihedralAngle, the equivalent atom order is:</span>
<span class="n">proper</span> <span class="o">=</span> <span class="n">DihedralAngle</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">C1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The atoms in an improper <code class="docutils literal notranslate"><span class="pre">DihedralAngle</span></code> must be specific so that the 1st atom is the central atom.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">4.97080909</span><span class="p">,</span> <span class="mf">2.91075722</span><span class="p">,</span> <span class="mf">1.57280005</span><span class="p">])</span>
<span class="n">C1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">5.12033922</span><span class="p">,</span> <span class="mf">4.63847287</span><span class="p">,</span> <span class="mf">4.94075943</span><span class="p">])</span>
<span class="n">C2</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">5.12991894</span><span class="p">,</span> <span class="mf">3.78609704</span><span class="p">,</span> <span class="mf">3.79996577</span><span class="p">])</span>
<span class="n">C3</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">4.91462725</span><span class="p">,</span> <span class="mf">4.08992816</span><span class="p">,</span> <span class="mf">2.5091264</span> <span class="p">])</span>
<span class="n">improper</span> <span class="o">=</span> <span class="n">DihedralAngle</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">C3</span><span class="p">],</span> <span class="n">improper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># The following are some of the equivalent permutations</span>
<span class="c1"># The only unique atom location is the first location (central atom)</span>
<span class="n">improper</span> <span class="o">=</span> <span class="n">DihedralAngle</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C3</span><span class="p">],</span> <span class="n">improper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">improper</span> <span class="o">=</span> <span class="n">DihedralAngle</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">C3</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">],</span> <span class="n">improper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">improper</span> <span class="o">=</span> <span class="n">DihedralAngle</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C3</span><span class="p">,</span> <span class="n">C2</span><span class="p">],</span> <span class="n">improper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Currently <code class="docutils literal notranslate"><span class="pre">Periodic</span></code> is the only <code class="docutils literal notranslate"><span class="pre">InteractionFunction</span></code> that can be applied to <code class="docutils literal notranslate"><span class="pre">DihedralAngle</span></code> interactions.</p>
</div>
<div class="section" id="Copying-bonded-atoms">
<h3>Copying bonded atoms<a class="headerlink" href="#Copying-bonded-atoms" title="Permalink to this headline">¶</a></h3>
<p>As mentioned above in the <strong>‘Create an atom’</strong> section, if an <code class="docutils literal notranslate"><span class="pre">Atom</span></code> with a <code class="docutils literal notranslate"><span class="pre">BondedInteraction</span></code> is copied, the new atom will also have the same <code class="docutils literal notranslate"><span class="pre">BondedInteraction</span></code> (and be bonded to the same atom or atoms as the original). For example:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wH1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">))</span>
<span class="n">wO</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">6.63298</span><span class="p">,</span> <span class="mf">5.</span><span class="p">))</span>
<span class="n">wBond</span> <span class="o">=</span> <span class="n">Bond</span><span class="p">((</span><span class="n">wH1</span><span class="p">,</span> <span class="n">wO</span><span class="p">),</span> <span class="n">function</span><span class="o">=</span><span class="n">HarmonicPotential</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="n">interaction_type</span><span class="o">=</span><span class="s1">&#39;bond&#39;</span><span class="p">))</span>
<span class="n">wH2</span> <span class="o">=</span> <span class="n">wH1</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.81649</span><span class="p">,</span> <span class="mf">0.57736</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Both atoms <code class="docutils literal notranslate"><span class="pre">wH1</span></code> and <code class="docutils literal notranslate"><span class="pre">wH2</span></code> are bonded to <code class="docutils literal notranslate"><span class="pre">wO</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wBond</span><span class="o">.</span><span class="n">atoms</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&lt;Atom
   {name: &#39;H&#39;,
    ID: 16,
    element: &#39;H&#39;,
    position: UnitNDArray([5., 5., 5.]) Ang,
    velocity: UnitNDArray([0., 0., 0.]) Ang / fs}&gt;, &lt;Atom
   {name: &#39;O&#39;,
    ID: 17,
    element: &#39;O&#39;,
    position: UnitNDArray([5.     , 6.63298, 5.     ]) Ang,
    velocity: UnitNDArray([0., 0., 0.]) Ang / fs}&gt;), (&lt;Atom
   {name: &#39;H&#39;,
    ID: 18,
    element: &#39;H&#39;,
    position: UnitNDArray([0.     , 0.81649, 0.57736]) Ang,
    velocity: UnitNDArray([0., 0., 0.]) Ang / fs}&gt;, &lt;Atom
   {name: &#39;O&#39;,
    ID: 17,
    element: &#39;O&#39;,
    position: UnitNDArray([5.     , 6.63298, 5.     ]) Ang,
    velocity: UnitNDArray([0., 0., 0.]) Ang / fs}&gt;)]
</pre></div></div>
</div>
</div>
<div class="section" id="Create-a-molecule">
<h3>Create a molecule<a class="headerlink" href="#Create-a-molecule" title="Permalink to this headline">¶</a></h3>
<p>A molecule consists of two or more atoms and at least one bonded interaction:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import the Atom, Molecule, Bond, BondAngle and HarmonicPotential classes</span>
<span class="kn">from</span> <span class="nn">MDMC.MD.structural_units</span> <span class="k">import</span> <span class="n">Molecule</span><span class="p">,</span> <span class="n">BondAngle</span>
<span class="c1"># Create a H2 molecule</span>
<span class="n">H_mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">H1</span><span class="p">,</span> <span class="n">H2</span><span class="p">],</span> <span class="n">interactions</span><span class="o">=</span><span class="p">[</span><span class="n">HH_bond</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>When a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> is created, the position of the atoms relative to one another is fixed. The atoms are then moved so that the position of the molecular centre of mass is what was passed when creating the molecule. In the example above, the atoms were at <code class="docutils literal notranslate"><span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]</span></code> and <code class="docutils literal notranslate"><span class="pre">[1.,</span> <span class="pre">1.,</span> <span class="pre">1.]</span></code> before <code class="docutils literal notranslate"><span class="pre">H_mol</span></code> was created; therefore they will always be separated by <code class="docutils literal notranslate"><span class="pre">1.0</span> <span class="pre">Ang</span></code> in each dimension, no matter where the molecule is moved to. The molecular centre of mass is set to <code class="docutils literal notranslate"><span class="pre">[1.5,</span> <span class="pre">1.5,</span> <span class="pre">1.5]</span></code>,
so the atom positions are changed to <code class="docutils literal notranslate"><span class="pre">[1.5,</span> <span class="pre">1.5,</span> <span class="pre">1.5]</span></code> and <code class="docutils literal notranslate"><span class="pre">[2.5,</span> <span class="pre">2.5,</span> <span class="pre">2.5]</span></code> respectively. It is also possible to <code class="docutils literal notranslate"><span class="pre">copy</span></code> molecules:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">H_mol2</span> <span class="o">=</span> <span class="n">H_mol</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>When a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> is copied, each <code class="docutils literal notranslate"><span class="pre">Atom</span></code> is copied, as are all of the bonded interactions between these atoms (and all of the non-bonded interactions).</p>
<p>One method for building molecules is to copy atoms, as the interactions are also copied. For example, to build methane:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m_C</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="c1"># Define the H atom positions relative to a C at [0,0,0]</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">0.629118</span>
<span class="n">H_pos</span> <span class="o">=</span> <span class="p">[[</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">],</span> <span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="o">-</span><span class="n">d</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="o">-</span><span class="n">d</span><span class="p">]]</span>
<span class="n">m_H</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">H_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># Add a bond between</span>
<span class="n">CH_bonds</span> <span class="o">=</span> <span class="n">Bond</span><span class="p">(</span><span class="n">m_C</span><span class="p">,</span> <span class="n">m_H</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">HarmonicPotential</span><span class="p">(</span><span class="mf">1.09</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="n">interaction_type</span><span class="o">=</span><span class="s1">&#39;bond&#39;</span><span class="p">))</span>
<span class="c1"># Make three H atom copies (which are therefore all bonded to m_C)</span>
<span class="n">H_atoms</span> <span class="o">=</span> <span class="p">[</span><span class="n">m_H</span><span class="p">]</span>
<span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">H_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">H_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_H</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
<span class="c1"># The next two lines simply create a list of unique HCH triplets</span>
<span class="c1"># e.g. [(m_H1, m_C, m_H2), (m_H1, m_C, m_H3), ..., (m_H3, m_C, m_H4)].</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">combinations</span>
<span class="n">HCH_triplets</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m_C</span><span class="p">,</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">H_atoms</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="c1"># Unpack the list of triplets with * notation i.e. [(...), (...), (...)] becomes (...), (...), (...)</span>
<span class="n">HCH_angles</span> <span class="o">=</span> <span class="n">BondAngle</span><span class="p">(</span><span class="o">*</span><span class="n">HCH_triplets</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">HarmonicPotential</span><span class="p">(</span><span class="mf">109.5</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="n">interaction_type</span><span class="o">=</span><span class="s1">&#39;angle&#39;</span><span class="p">))</span>
<span class="c1"># Create a methane molecule by adding C atom to list of H atoms</span>
<span class="n">methane</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">m_C</span><span class="p">]</span><span class="o">+</span><span class="n">H_atoms</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Creating-molecules-using-configuration-files">
<h3>Creating molecules using configuration files<a class="headerlink" href="#Creating-molecules-using-configuration-files" title="Permalink to this headline">¶</a></h3>
<p>In addition to creating molecules manually, it is also possible to create them from atomic configuration files (e.g CIF files). Please see the tutorial <a class="reference internal" href="read-configurations.html"><span class="doc">Reading atoms from configuration files</span></a> for a detailed description on how to do this.</p>
</div>
<div class="section" id="Add-structural-units-to-a-universe">
<h3>Add structural units to a universe<a class="headerlink" href="#Add-structural-units-to-a-universe" title="Permalink to this headline">¶</a></h3>
<p>There are two methods for adding a structural unit to a universe:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Add an individual structural unit to the universe</span>
<span class="n">universe</span><span class="o">.</span><span class="n">add_structural_unit</span><span class="p">(</span><span class="n">H_mol</span><span class="p">)</span>
<span class="c1"># Fill the universe with the structural unit repeated on a cubic lattice with a specific number density</span>
<span class="n">universe</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">H_mol</span><span class="p">,</span> <span class="n">num_density</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Currently the <code class="docutils literal notranslate"><span class="pre">fill</span></code> command is limited to filling with a cubic lattice, and cannot be used in conjunction with <code class="docutils literal notranslate"><span class="pre">add_structural_unit</span></code>.</p>
</div>
<div class="section" id="Create-non-bonded-interactions">
<h3>Create non-bonded interactions<a class="headerlink" href="#Create-non-bonded-interactions" title="Permalink to this headline">¶</a></h3>
<p>Non-bonded interactions are applied to atoms based on their <code class="docutils literal notranslate"><span class="pre">atom_type</span></code>, rather than to individual atoms. They must also have a <code class="docutils literal notranslate"><span class="pre">Universe</span></code> specified, so that they know which atoms they apply to (atoms must have an atom_type once they have been added to a universe). For example, to create a <code class="docutils literal notranslate"><span class="pre">Dispersion</span></code> interaction with a <code class="docutils literal notranslate"><span class="pre">LennardJones</span></code> interaction function between two atom types:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import the Dispersion interaction and Lennard-Jones function</span>
<span class="kn">from</span> <span class="nn">MDMC.MD.structural_units</span> <span class="k">import</span> <span class="n">Dispersion</span>
<span class="kn">from</span> <span class="nn">MDMC.MD.interaction_functions</span> <span class="k">import</span> <span class="n">LennardJones</span>
<span class="c1"># Create a dispersion interaction with a Lennard-Jones function between atoms with atom_type 1 (O) and atom_type 2 (H)</span>
<span class="c1"># The first LJ parameter is epsilon and the second is sigma</span>
<span class="c1"># The cutoff for the dispersion interaction can also be set (in Ang)</span>
<span class="n">LJ_HO</span> <span class="o">=</span> <span class="n">Dispersion</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">function</span><span class="o">=</span><span class="n">LennardJones</span><span class="p">(</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">3.</span><span class="p">),</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The exception to this is <code class="docutils literal notranslate"><span class="pre">Coulombic</span></code> interactions, which can be applied either to a list of atoms or to a list of atom types. If the Coulombic interaction is applied to a list of atoms, the universe does not need to be specified:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import the Coulombic interaction</span>
<span class="kn">from</span> <span class="nn">MDMC.MD.structural_units</span> <span class="k">import</span> <span class="n">Coulombic</span>
<span class="c1"># Create a Coulombic interaction with a Coulomb potential and a charge of 0.42</span>
<span class="n">c_H</span> <span class="o">=</span> <span class="n">Coulombic</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">H1</span><span class="p">,</span> <span class="n">H2</span><span class="p">],</span> <span class="n">charge</span><span class="o">=</span><span class="mf">0.42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
../../MDMC/MD/structural_units.py:2026: UserWarning: Coulombic interaction for the Atom object initialized with the Coulomb interaction function.
  warnings.warn(UserWarning(&#39;Coulombic interaction for the Atom &#39;
</pre></div></div>
</div>
<p>As <code class="docutils literal notranslate"><span class="pre">Coulombic</span></code> interactions typically have the same interaction function (i.e. a <code class="docutils literal notranslate"><span class="pre">Coulomb</span></code> function, where the force results in Coulomb’s law), <code class="docutils literal notranslate"><span class="pre">Coulombic</span></code> interactions do not need to be specified with an interaction function (although other functions can be provided); to set the function as <code class="docutils literal notranslate"><span class="pre">Coulomb</span></code>, a value for the charge can be passed. The warning highlights the <code class="docutils literal notranslate"><span class="pre">Coulomb</span></code> interaction function has been automatically set. This is equivalent to:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">MDMC.MD.interaction_functions</span> <span class="k">import</span> <span class="n">Coulomb</span>
<span class="n">c_H</span> <span class="o">=</span> <span class="n">Coulombic</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">H1</span><span class="p">,</span> <span class="n">H2</span><span class="p">],</span> <span class="n">function</span><span class="o">=</span><span class="n">Coulomb</span><span class="p">(</span><span class="mf">0.42</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>As with all non-bonded interactions, a Coulombic interaction can also be created by specifying the atom types:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">c_O</span> <span class="o">=</span> <span class="n">Coulombic</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">atom_types</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">charge</span><span class="o">=</span><span class="mf">0.42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In this case a universe must be provided.</p>
</div>
<div class="section" id="Applying-a-ForceField">
<h3>Applying a <code class="docutils literal notranslate"><span class="pre">ForceField</span></code><a class="headerlink" href="#Applying-a-ForceField" title="Permalink to this headline">¶</a></h3>
<p>As well as manually setting the <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> values for each interaction (e.g. <code class="docutils literal notranslate"><span class="pre">Coulombic(atoms=[H1,</span> <span class="pre">H2],</span> <span class="pre">function=Coulomb(0.42))</span></code> to set the <code class="docutils literal notranslate"><span class="pre">charge</span></code>), it is also possible to apply a <code class="docutils literal notranslate"><span class="pre">ForceField</span></code> to a <code class="docutils literal notranslate"><span class="pre">Universe</span></code>, in order to set the <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> values. Please see the tutorial <a class="reference internal" href="applying-a-forcefield.html"><span class="doc">Applying a ForceField</span></a> for a detailed description on how to do this.</p>
</div>
<div class="section" id="Adding-kspace-solvers-to-a-universe">
<h3>Adding kspace solvers to a universe<a class="headerlink" href="#Adding-kspace-solvers-to-a-universe" title="Permalink to this headline">¶</a></h3>
<p>There are several solvers for determining the long range energy contribution for non-bonded interactions, including Ewald, particle-particle particle-mesh (PPPM), and particle-mesh Ewald (PME). If the long range contribution to the non-bonded energy (i.e. &gt; cutoff) is to be calculated during a simulation, a kspace solver has to be added to the universe. A solver can be specified for either electrostatic or dispersive interactions, or both. This can either be during universe initialisation or
afterwards:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import Ewald and PPPM kspace solvers</span>
<span class="kn">from</span> <span class="nn">MDMC.MD.simulation</span> <span class="k">import</span> <span class="n">Ewald</span><span class="p">,</span> <span class="n">PPPM</span>
<span class="c1"># Create an ewald solver</span>
<span class="n">ewald</span> <span class="o">=</span> <span class="n">Ewald</span><span class="p">(</span><span class="n">accuracy</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="c1"># Initialise a universe with an Ewald solver for both electrostatics and dispersive interactions</span>
<span class="n">uni1</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="n">kspace_solver</span><span class="o">=</span><span class="n">ewald</span><span class="p">)</span>
<span class="c1"># Initialise a universe and then add a PPPM solver for electrostatic interactions</span>
<span class="n">uni2</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">pppm</span> <span class="o">=</span> <span class="n">PPPM</span><span class="p">(</span><span class="n">accuracy</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">uni2</span><span class="o">.</span><span class="n">electrostatic_solver</span> <span class="o">=</span> <span class="n">pppm</span>
<span class="c1"># Initialise a universe with a PPPM solver for dispersive interactions</span>
<span class="n">uni3</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="n">dispersive_solver</span><span class="o">=</span><span class="n">PPPM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Not all kspace solvers are implemented for all MD engines, and they may also require different parameters to be specified - see the MD engine documentation for more information.</p>
</div>
<div class="section" id="Adding-constraint-algorithms-to-a-universe">
<h3>Adding constraint algorithms to a universe<a class="headerlink" href="#Adding-constraint-algorithms-to-a-universe" title="Permalink to this headline">¶</a></h3>
<p>In a similar manner to kspace solvers, constraint algorithms (e.g. SHAKE, RATTLE) can also be passed to a universe. A constraint algorithm is required if any of the bonded interactions are constrained.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import Shake and Rattle</span>
<span class="kn">from</span> <span class="nn">MDMC.MD.simulation</span> <span class="k">import</span> <span class="n">Shake</span><span class="p">,</span> <span class="n">Rattle</span>
<span class="c1"># Initialise a universe with the Shake algorithm</span>
<span class="c1"># The first Shake parameter is the accuracy and the second is the maximum number of iterations used for any constraint calculation</span>
<span class="n">shake</span> <span class="o">=</span> <span class="n">Shake</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">uni4</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="n">constraint_algorithm</span><span class="o">=</span><span class="n">shake</span><span class="p">)</span>
<span class="c1"># Add Rattle after universe initialisation</span>
<span class="n">rattle</span> <span class="o">=</span> <span class="n">Rattle</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">uni5</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">uni5</span><span class="o">.</span><span class="n">constraint_algorithm</span> <span class="o">=</span> <span class="n">rattle</span>
</pre></div>
</div>
</div>
<p>Not all constraint algorithms are implemented for all MD engines, and they may also required different parameters to be specified - see the MD engine documentation for more information.</p>
</div>
</div>
<div class="section" id="Example-Universe-filled-with-SPCE-water">
<h2>Example Universe filled with SPCE water<a class="headerlink" href="#Example-Universe-filled-with-SPCE-water" title="Permalink to this headline">¶</a></h2>
<p>For water, SPCE and SPC forcefields are predefined, so parameters do not need to be set when interactions are defined; instead parameters are set by adding a forcefield to the universe.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">MDMC.MD.simulation</span> <span class="k">import</span> <span class="n">Universe</span><span class="p">,</span> <span class="n">Shake</span><span class="p">,</span> <span class="n">PPPM</span>
<span class="kn">from</span> <span class="nn">MDMC.MD.structural_units</span> <span class="k">import</span> <span class="n">Atom</span><span class="p">,</span> <span class="n">Bond</span><span class="p">,</span> <span class="n">BondAngle</span><span class="p">,</span> <span class="n">Coulombic</span><span class="p">,</span> <span class="n">Dispersion</span><span class="p">,</span> <span class="n">Molecule</span>

<span class="n">universe</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">dimensions</span><span class="o">=</span><span class="mf">21.75</span><span class="p">,</span> <span class="n">constraint_algorithm</span><span class="o">=</span><span class="n">Shake</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">electrostatic_solver</span><span class="o">=</span><span class="n">PPPM</span><span class="p">(</span><span class="n">accuracy</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">))</span>
<span class="n">H1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
<span class="n">H2</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.63298</span><span class="p">,</span> <span class="mf">0.</span><span class="p">))</span>
<span class="n">O</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.81649</span><span class="p">,</span> <span class="mf">0.57736</span><span class="p">))</span>
<span class="n">H_coulombic</span> <span class="o">=</span> <span class="n">Coulombic</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">H1</span><span class="p">,</span> <span class="n">H2</span><span class="p">],</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">O_coulombic</span> <span class="o">=</span> <span class="n">Coulombic</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">O</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">water_mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                     <span class="n">velocity</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                     <span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">H1</span><span class="p">,</span> <span class="n">H2</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span>
                     <span class="n">interactions</span><span class="o">=</span><span class="p">[</span><span class="n">Bond</span><span class="p">((</span><span class="n">H1</span><span class="p">,</span> <span class="n">O</span><span class="p">),</span> <span class="p">(</span><span class="n">H2</span><span class="p">,</span> <span class="n">O</span><span class="p">),</span> <span class="n">constrained</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                   <span class="n">BondAngle</span><span class="p">(</span><span class="n">H1</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">H2</span><span class="p">,</span> <span class="n">constrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)],</span>
                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;water&#39;</span><span class="p">)</span>
<span class="n">universe</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">water_mol</span><span class="p">,</span> <span class="n">num_density</span><span class="o">=</span><span class="mf">0.03356718472021752</span><span class="p">)</span>
<span class="n">O_dispersion</span> <span class="o">=</span> <span class="n">Dispersion</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="p">[</span><span class="n">O</span><span class="o">.</span><span class="n">atom_type</span><span class="p">,</span> <span class="n">O</span><span class="o">.</span><span class="n">atom_type</span><span class="p">],</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">vdw_tail_correction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">universe</span><span class="o">.</span><span class="n">add_force_field</span><span class="p">(</span><span class="s1">&#39;SPCE&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="read-configurations.html" class="btn btn-neutral float-right" title="Reading atoms from configuration files" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../pages/parameter-refinement.html" class="btn btn-neutral float-left" title="4. Parameter Refinement" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Thomas Farmer

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>