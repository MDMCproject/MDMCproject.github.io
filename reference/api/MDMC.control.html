<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MDMC.control package &mdash; MDMC 0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=10f1778b"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MDMC.exporters package" href="MDMC.exporters.html" />
    <link rel="prev" title="MDMC.common package" href="MDMC.common.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            MDMC
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">2. Contributing to MDMC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/Argon-a-to-z.html">Argon A-to-Z</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/equilibrating-a-simulation.html">Equilibrating simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/running-a-refinement.html">Running a Refinement (in detail)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/understanding-units.html">Understanding scientific units in MDMC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-to</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/use-MDMC.html">How to use MDMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">MDMC</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="MDMC.html">MDMC package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="MDMC.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="MDMC.MD.html">MDMC.MD package</a></li>
<li class="toctree-l4"><a class="reference internal" href="MDMC.common.html">MDMC.common package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">MDMC.control package</a></li>
<li class="toctree-l4"><a class="reference internal" href="MDMC.exporters.html">MDMC.exporters package</a></li>
<li class="toctree-l4"><a class="reference internal" href="MDMC.gui.html">MDMC.gui package</a></li>
<li class="toctree-l4"><a class="reference internal" href="MDMC.readers.html">MDMC.readers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="MDMC.refinement.html">MDMC.refinement package</a></li>
<li class="toctree-l4"><a class="reference internal" href="MDMC.resolution.html">MDMC.resolution package</a></li>
<li class="toctree-l4"><a class="reference internal" href="MDMC.trajectory_analysis.html">MDMC.trajectory_analysis package</a></li>
<li class="toctree-l4"><a class="reference internal" href="MDMC.utilities.html">MDMC.utilities package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="MDMC.html#module-MDMC">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Explanation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../explanation/explanation.html">Explanation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../developer/overview.html">Developer Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MDMC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">MDMC</a></li>
          <li class="breadcrumb-item"><a href="MDMC.html">MDMC package</a></li>
      <li class="breadcrumb-item active">MDMC.control package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/reference/api/MDMC.control.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mdmc-control-package">
<h1>MDMC.control package<a class="headerlink" href="#mdmc-control-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-MDMC.control.control">
<span id="mdmc-control-control-module"></span><h2>MDMC.control.control module<a class="headerlink" href="#module-MDMC.control.control" title="Link to this heading"></a></h2>
<p>A module for performing the refinement</p>
<dl class="py class">
<dt class="sig sig-object py" id="MDMC.control.control.Control">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MDMC.control.control.</span></span><span class="sig-name descname"><span class="pre">Control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="MDMC.MD.html#MDMC.MD.simulation.Simulation" title="MDMC.MD.simulation.Simulation"><span class="pre">Simulation</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_datasets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="MDMC.MD.html#MDMC.MD.parameters.Parameters" title="MDMC.MD.parameters.Parameters"><span class="pre">Parameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimizer_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'MMC'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FoM_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MD_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equilibration_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><span class="pre">Path</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_all_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.control.Control" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Controls the MDMC refinement</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation</strong> (<a class="reference internal" href="MDMC.MD.html#MDMC.MD.simulation.Simulation" title="MDMC.MD.simulation.Simulation"><em>Simulation</em></a>) – Performs a simulation for a given set of potential <code class="docutils literal notranslate"><span class="pre">Parameter</span></code>
objects.</p></li>
<li><p><strong>exp_datasets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><em>dicts</em>) – <p>Each <cite>dict</cite> represents an experimental dataset, containing the
following keys:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">file_name</span></code> (<cite>str</cite>) the file name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> (<cite>str</cite>) the type of observable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reader</span></code> (<cite>str</cite>) the reader required for the file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weighting</span></code> (<cite>float</cite>) the weighting of the dataset to be used in
the Figure of Merit calculation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resolution</span></code> : (<cite>dict</cite>, but can be <cite>str</cite>, <cite>float</cite>, or None)
Should be a one-line dict of format {‘file’ : str} or {key : float}
if {‘file’ : str}, the str should be a file in
the same format as <code class="docutils literal notranslate"><span class="pre">file_name</span></code> containing results of a vanadium
sample which is used to determine instrument energy resolution for
this dataset.
If {key : float}, the key should be the type of resolution function.
allowed types are ‘gaussian’ and ‘lorentzian’
Can also be ‘lazily’ given as just a <cite>str</cite> or <cite>float</cite>.
If just a string is given, it is assumed to be a filename.
If just a float is given, it is assumed to be Gaussian.
The float should be the instrument energy resolution as the FWHM in <code class="docutils literal notranslate"><span class="pre">ueV</span></code> (micro eV).
If you have already accounted for instrument resolution in your dataset,
this field can be set to None, and resolution application will be skipped.
This must be done explicitly.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rescale_factor</span></code> (<cite>float</cite>, optional, defaults to <cite>1.</cite>) applied to
the experimental data when calculating the FoM to ensure it is on
the same scale as the calculated observable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">auto_scale</span></code> (<cite>bool</cite>, optional, defaults to <cite>False</cite>) set the
<code class="docutils literal notranslate"><span class="pre">rescale_factor</span></code> automatically to minimise the FoM, if both
<code class="docutils literal notranslate"><span class="pre">rescale_factor</span></code> and <code class="docutils literal notranslate"><span class="pre">auto_scale</span></code> are provided then a warning
is printed and <code class="docutils literal notranslate"><span class="pre">auto_scale</span></code> takes precedence</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_FFT</span></code> (<cite>bool</cite>, optional, defaults to <cite>True</cite>) whether to use
Fast Fourier Transforms in the calculation of dependent variables.
FFT speeds up calculation but places restrictions on spacing in the
independent variable domain(s). This option may not be supported
for all <a href="#id1"><span class="problematic" id="id2">``</span></a>Observable``s</p></li>
</ul>
</div></blockquote>
<p>Note that the default (and preferred) behaviour of the scaling settings requires that the
dataset provided has been properly scaled and normalised for the refinement process.
Arbitrary or automatic rescaling should be undertaken with care, as it does not take into
account any physical aspects of scaling the data, such as the presence or absence of
background events from peaks outside its range.</p>
</p></li>
<li><p><strong>fit_parameters</strong> (<a class="reference internal" href="MDMC.MD.html#MDMC.MD.parameters.Parameters" title="MDMC.MD.parameters.Parameters"><em>Parameters</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference internal" href="MDMC.MD.html#MDMC.MD.parameters.Parameter" title="MDMC.MD.parameters.Parameter"><em>Parameter</em></a>) – All parameters which will be refined. Note that any <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> that is <code class="docutils literal notranslate"><span class="pre">fixed</span></code>,
<code class="docutils literal notranslate"><span class="pre">tied</span></code> or equal to 0 will not be passed to the minimizer as these cannot be refined.
Those with <code class="docutils literal notranslate"><span class="pre">constraints</span></code> set are still passed.</p></li>
<li><p><strong>minimizer_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The <code class="docutils literal notranslate"><span class="pre">Minimizer</span></code> type. Default is ‘MMC’.</p></li>
<li><p><strong>FoM_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> of </em><em>{str : str}</em><em>, </em><em>optional</em>) – <p>Defines the details of the <code class="docutils literal notranslate"><span class="pre">FigureOfMeritCalculator</span></code> to use. Default is <cite>None</cite>, in which
case the first option for each of the following keys is used:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">errors</span></code> {‘exp’, ‘none’} Whether to weight the differences between MD and
experimental data with the experimental error or not (errors from MD are not currently
supported).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">norm</span></code> {‘data_points’, ‘dof’, ‘none’} How to normalise the FoM, either by the total
number of data_points (n), the degrees of freedom (n - m, where m is the number of
parameters being varied), or not at all.</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>reset_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Determines if the configuration is reset to the end of the last accepted
state. Default is <cite>True</cite>.</p></li>
<li><p><strong>MD_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of molecular dynamics steps for each step of the refinement.
When not provided, the minimum number of steps needed for successful
calculation of the observables is used. If provided, the actual number
of steps may be reduced to prevent running MD that won’t be used when
calculating dependent variables. Default is <cite>None</cite>.</p></li>
<li><p><strong>equilibration_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of molecular dynamics steps used to equilibrate the <code class="docutils literal notranslate"><span class="pre">Universe</span></code>
in between each refinement step. When changes to the <code class="docutils literal notranslate"><span class="pre">Parameters</span></code> are small,
this equilibration can be much shorter than the equilibration needed before
starting the refinement process, but in general will vary depending on
the details of the <code class="docutils literal notranslate"><span class="pre">Universe</span></code> and <code class="docutils literal notranslate"><span class="pre">Parameters</span></code>. Default is 0.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The level of verbosity:
Verbose level -1 hides all outputs for tests.
Verbose level 0 gives no information.
Verbose level 1 gives final time for the whole method.
Verbose level 2 gives final time and also a progress bar.
Verbose level 3 gives final time, a progress bar, and time per step.</p></li>
<li><p><strong>print_full_settings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print all settings/attributes/parameters passed to this object,
defaults to False.</p></li>
<li><p><strong>**settings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <dl class="simple">
<dt>n_steps: int</dt><dd><p>The maximum number of refinement steps to be. An optional parameter that,
if specified, will be used in the <code class="docutils literal notranslate"><span class="pre">refine</span></code> method unless a different value
of <code class="docutils literal notranslate"><span class="pre">n_steps</span></code> is explicitly passed when running <code class="docutils literal notranslate"><span class="pre">refine</span></code>.</p>
</dd>
<dt>cont_slicing<span class="classifier">bool, optional</span></dt><dd><p>Flag to decide between two possible behaviours when the number of <code class="docutils literal notranslate"><span class="pre">MD_steps</span></code> is
larger than the minimum required to calculate the observables. If <code class="docutils literal notranslate"><span class="pre">False</span></code> (default)
then the <code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code> is sliced into non-overlapping sub-<code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code>
blocks for each of which the observable is calculated. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the
<code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code> is sliced into as many non-identical sub-<code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code>
blocks as possible (with overlap allowed).</p>
</dd>
<dt>results_filename: str</dt><dd><p>The name of the file in which the results of the MDMC run will be stored</p>
</dd>
<dt>MC_norm: int</dt><dd><p>1 if the MMC minimiser is to be used for parameter optimisation.</p>
</dd>
<dt>use_average<span class="classifier">bool, optional</span></dt><dd><p>Optional parameter relevant in case <code class="docutils literal notranslate"><span class="pre">MD_steps</span></code> is larger than the minimum required
and the MD <code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code> is sliced into sub-<code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code> blocks.
If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) the observables are averaged over the sub-<code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code>
blocks. If <code class="docutils literal notranslate"><span class="pre">False</span></code> they are not averaged.</p>
</dd>
<dt>data_printer: str, default ‘plaintext’</dt><dd><p>How to display the data during minimisation. Current options are ‘plaintext’ (default,
plaintext printing) or ‘ipython’ (prettier HTML printing via iPython)</p>
</dd>
<dt>time_step_reductions<span class="classifier">int, optional</span></dt><dd><p>The number of attempts to reduce the time_step of the simulation in order to fix an
equilibration that keeps failing. Defaults to a value of 2.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>An example of an exp_dataset list is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;file_name&#39;</span><span class="p">:</span><span class="n">data</span><span class="o">.</span><span class="n">LAMP_SQW_FILE</span><span class="p">,</span>
  <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;SQw&#39;</span><span class="p">,</span>
  <span class="s1">&#39;reader&#39;</span><span class="p">:</span><span class="s1">&#39;LAMPSQw&#39;</span><span class="p">,</span>
  <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">,</span>
  <span class="s1">&#39;resolution&#39;</span><span class="p">:{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span><span class="n">data</span><span class="o">.</span><span class="n">LAMP_SQW_VAN_FILE</span><span class="p">}</span>
  <span class="s1">&#39;rescale_factor&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;file_name:data.ANOTHER_FILE&#39;</span><span class="p">,</span>
  <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;FQt&#39;</span><span class="p">,</span>
  <span class="s1">&#39;reader&#39;</span><span class="p">:</span><span class="s1">&#39;GENERIC_READER&#39;</span><span class="p">,</span>
  <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
  <span class="s1">&#39;resolution&#39;</span><span class="p">:{</span><span class="s1">&#39;gaussian&#39;</span><span class="p">:</span><span class="mf">2.35</span><span class="p">}</span>
  <span class="s1">&#39;auto_scale&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}]</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.control.Control.simulation">
<span class="sig-name descname"><span class="pre">simulation</span></span><a class="headerlink" href="#MDMC.control.control.Control.simulation" title="Link to this definition"></a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> on which is used to perform the refinement</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MDMC.MD.html#MDMC.MD.simulation.Simulation" title="MDMC.MD.simulation.Simulation">Simulation</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.control.Control.exp_datasets">
<span class="sig-name descname"><span class="pre">exp_datasets</span></span><a class="headerlink" href="#MDMC.control.control.Control.exp_datasets" title="Link to this definition"></a></dt>
<dd><p>One <cite>dict</cite> per experimental dataset used for the refinement</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>list of dicts</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.control.Control.fit_parameters">
<span class="sig-name descname"><span class="pre">fit_parameters</span></span><a class="headerlink" href="#MDMC.control.control.Control.fit_parameters" title="Link to this definition"></a></dt>
<dd><p>All <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> objects which will be refined</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MDMC.MD.html#MDMC.MD.parameters.Parameters" title="MDMC.MD.parameters.Parameters">Parameters</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.control.Control.minimizer">
<span class="sig-name descname"><span class="pre">minimizer</span></span><a class="headerlink" href="#MDMC.control.control.Control.minimizer" title="Link to this definition"></a></dt>
<dd><p>Refines the potential parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MDMC.refinement.minimizers.html#MDMC.refinement.minimizers.minimizer_abs.Minimizer" title="MDMC.refinement.minimizers.minimizer_abs.Minimizer">Minimizer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.control.Control.observable_pairs">
<span class="sig-name descname"><span class="pre">observable_pairs</span></span><a class="headerlink" href="#MDMC.control.control.Control.observable_pairs" title="Link to this definition"></a></dt>
<dd><p>Experimental observable/MD observable pairs which are used to calculate
the Figure of Merit</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>list</cite> of <code class="docutils literal notranslate"><span class="pre">ObservablePairs</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.control.Control.FoM_calculator">
<span class="sig-name descname"><span class="pre">FoM_calculator</span></span><a class="headerlink" href="#MDMC.control.control.Control.FoM_calculator" title="Link to this definition"></a></dt>
<dd><p>Calculates the FoM <cite>float</cite> from the <code class="docutils literal notranslate"><span class="pre">observable_pairs</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>FigureOfMeritCalculator</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.control.Control.MD_steps">
<span class="sig-name descname"><span class="pre">MD_steps</span></span><a class="headerlink" href="#MDMC.control.control.Control.MD_steps" title="Link to this definition"></a></dt>
<dd><p>Number of molecular dynamics steps for each step of the refinement</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.control.Control.calculate_max_FoM">
<span class="sig-name descname"><span class="pre">calculate_max_FoM</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.calculate_max_FoM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.control.Control.calculate_max_FoM" title="Link to this definition"></a></dt>
<dd><p>Calculates a maximum Figure of Merit value by comparing a set of experimental observable
data, to arrays consisting of numbers close to zero. For use when the MD Engine fails with
a set of parameter values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>max_FoM</strong> – value of maximum FoM</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.control.Control.engine_recovery_from_equil">
<span class="sig-name descname"><span class="pre">engine_recovery_from_equil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.engine_recovery_from_equil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.control.Control.engine_recovery_from_equil" title="Link to this definition"></a></dt>
<dd><p>Handles an MDEngineError thrown by the MD engine. Currently this error is only raised by
LAMMPS.</p>
<p>The time_step is reduced, and the engine cleared, and then an equilibration is performed.
If the equilibration is unsuccessful when the attempt limit is reached, an MDEngineError is
raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of simulation steps to run.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print statements upon starting and completing the run.</p></li>
<li><p><strong>output_log</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Log file for the MD engine to write to.</p></li>
<li><p><strong>work_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Working directory for the MD engine to write to.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.control.Control.equilibrate">
<span class="sig-name descname"><span class="pre">equilibrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.equilibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.control.Control.equilibrate" title="Link to this definition"></a></dt>
<dd><p>Run molecular dynamics to equilibrate the <code class="docutils literal notranslate"><span class="pre">Universe</span></code>.</p>
<p>If the equilibration fails, a method to reduce the time_step and re-try, is called.
If this re-try also fails, then an MDEngineError is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of simulation steps to run.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print statements upon starting and completing the run.
Default is <cite>False</cite>.</p></li>
<li><p><strong>output_log</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Log file for the MD engine to write to. Default is <cite>None</cite>.</p></li>
<li><p><strong>work_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Working directory for the MD engine to write to. Default is <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.control.Control.minimize">
<span class="sig-name descname"><span class="pre">minimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimize_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.minimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.control.Control.minimize" title="Link to this definition"></a></dt>
<dd><p>Performs an MD run intertwined with periodic structure relaxation.
This way after a local minimum is found, the system is taken
out of the minimum to explore a larger volume of the parameter
space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Total number of the MD run steps</p></li>
<li><p><strong>minimize_every</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of MD steps between two consecutive minimizations</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print statements when the minimization has been started and completed
(including the number of minimization steps and time taken). Default is <cite>False</cite>.</p></li>
<li><p><strong>output_log</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Log file for the MD engine to write to. Default is <cite>None</cite>.</p></li>
<li><p><strong>work_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Working directory for the MD engine to write to. Default is <cite>None</cite>.</p></li>
<li><p><strong>**settings</strong> – <dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">etol</span></code> (<cite>float</cite>)</dt><dd><p>If the energy change between iterations is less than <code class="docutils literal notranslate"><span class="pre">etol</span></code>,
minimization is stopped. Default depends on engine used.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ftol</span></code> (<cite>float</cite>)</dt><dd><p>If the magnitude of the global force is less than <code class="docutils literal notranslate"><span class="pre">ftol</span></code>,
minimization is stopped. Default depends on engine used.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">maxiter</span></code> (<cite>int</cite>)</dt><dd><p>Maximum number of iterations of a single structure
relaxation procedure. Default depends on engine used.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">maxeval</span></code> (<cite>int</cite>)</dt><dd><p>Maximum number of force evaluations to perform. Default depends
on engine used.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.control.Control.plot_results">
<span class="sig-name descname"><span class="pre">plot_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MH_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.plot_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.control.Control.plot_results" title="Link to this definition"></a></dt>
<dd><p>Instantiates an insstance of the PlotResults class and generates a cornerplot
from the data in self.results_filename</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The filename and path to the history file. Defaults to None which
then uses self.results_filename</p></li>
<li><p><strong>points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The number of samples to initially generate, defaults to 100,000</p></li>
<li><p><strong>MH_norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – The denominator of the exponent, controlling how likley points are to be kept,
defaults to 20.0</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>corner plot</strong> – A plot displaying every parameter combination with their variances and covariances</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.control.Control.refine">
<span class="sig-name descname"><span class="pre">refine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.refine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.control.Control.refine" title="Link to this definition"></a></dt>
<dd><p>Refines the specified potential parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum number of steps for the refinement. Must be specified either when creating
the <code class="docutils literal notranslate"><span class="pre">Control</span></code> object or when calling this method. The value specified to this
method supersedes the value passed (if any) when the <code class="docutils literal notranslate"><span class="pre">Control</span></code> object was created.
If nothing is passed, the method will check if a number was specified when the
<code class="docutils literal notranslate"><span class="pre">Control</span></code> object was created and use that value.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Perform a refinement with a maximum of 100 steps:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>control.refine(100)</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.control.Control.reset_engine">
<span class="sig-name descname"><span class="pre">reset_engine</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.reset_engine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.control.Control.reset_engine" title="Link to this definition"></a></dt>
<dd><p>Clears and resets the MD engine when there is an error thrown by the
equilibration or production methods. Currently this is only applicable to LAMMPS.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.control.Control.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bad_param_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.control.Control.step" title="Link to this definition"></a></dt>
<dd><p>Do a full step: generate and run MD to calculate FoM for existing
parameters, iterate parameters a step forward and reset MD (phasespace)
if previous step was rejected and reset_config = true</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bad_param_location</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Represents whether the equilibration at these parameter value failed or not.
If equilibration failed, value is True.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.control.Control.trial_reduce_time_step">
<span class="sig-name descname"><span class="pre">trial_reduce_time_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduction_factor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.trial_reduce_time_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.control.Control.trial_reduce_time_step" title="Link to this definition"></a></dt>
<dd><p>Reduces the time_step by the reduction factor specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>reduction_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – represents the value which will be multiplied with the time_step in order to reduce it</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-MDMC.control.plot_results">
<span id="mdmc-control-plot-results-module"></span><h2>MDMC.control.plot_results module<a class="headerlink" href="#module-MDMC.control.plot_results" title="Link to this heading"></a></h2>
<p>A module for plotting data and results of a minimization.</p>
<dl class="py class">
<dt class="sig sig-object py" id="MDMC.control.plot_results.DataPrinter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MDMC.control.plot_results.</span></span><span class="sig-name descname"><span class="pre">DataPrinter</span></span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#DataPrinter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.DataPrinter" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>A class for printing data during a minimisation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.plot_results.DataPrinter.print_data">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">print_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#DataPrinter.print_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.DataPrinter.print_data" title="Link to this definition"></a></dt>
<dd><p>Update table at the end of a refinement step.</p>
<p>Parameters:
history</p>
<blockquote>
<div><p>The history of the minimizer data is printed from.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.plot_results.DataPrinter.print_header">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">print_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#DataPrinter.print_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.DataPrinter.print_header" title="Link to this definition"></a></dt>
<dd><p>Create table headers at the start of refinement.</p>
<p>Parameters:
history</p>
<blockquote>
<div><p>The history of the minimizer data is printed from.</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MDMC.control.plot_results.IPythonDataPrinter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MDMC.control.plot_results.</span></span><span class="sig-name descname"><span class="pre">IPythonDataPrinter</span></span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#IPythonDataPrinter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.IPythonDataPrinter" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#MDMC.control.plot_results.DataPrinter" title="MDMC.control.plot_results.DataPrinter"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataPrinter</span></code></a></p>
<p>Prettier IPython data printer, for Jupyter Notebooks, etc.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.plot_results.IPythonDataPrinter.print_data">
<span class="sig-name descname"><span class="pre">print_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#IPythonDataPrinter.print_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.IPythonDataPrinter.print_data" title="Link to this definition"></a></dt>
<dd><p>Update table at the end of a refinement step.</p>
<p>Parameters:
history</p>
<blockquote>
<div><p>The history of the minimizer data is printed from.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.plot_results.IPythonDataPrinter.print_header">
<span class="sig-name descname"><span class="pre">print_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#IPythonDataPrinter.print_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.IPythonDataPrinter.print_header" title="Link to this definition"></a></dt>
<dd><p>Create table headers at the start of refinement.</p>
<p>Parameters:
history</p>
<blockquote>
<div><p>The history of the minimizer data is printed from.</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MDMC.control.plot_results.PlaintextDataPrinter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MDMC.control.plot_results.</span></span><span class="sig-name descname"><span class="pre">PlaintextDataPrinter</span></span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#PlaintextDataPrinter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.PlaintextDataPrinter" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#MDMC.control.plot_results.DataPrinter" title="MDMC.control.plot_results.DataPrinter"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataPrinter</span></code></a></p>
<p>Plaintext data printer.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.plot_results.PlaintextDataPrinter.print_data">
<span class="sig-name descname"><span class="pre">print_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#PlaintextDataPrinter.print_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.PlaintextDataPrinter.print_data" title="Link to this definition"></a></dt>
<dd><p>Update table at the end of a refinement step.</p>
<p>Parameters:
history</p>
<blockquote>
<div><p>The history of the minimizer data is printed from.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.plot_results.PlaintextDataPrinter.print_header">
<span class="sig-name descname"><span class="pre">print_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#PlaintextDataPrinter.print_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.PlaintextDataPrinter.print_header" title="Link to this definition"></a></dt>
<dd><p>Create table headers at the start of refinement.</p>
<p>Parameters:
history</p>
<blockquote>
<div><p>The history of the minimizer data is printed from.</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MDMC.control.plot_results.PlotResults">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MDMC.control.plot_results.</span></span><span class="sig-name descname"><span class="pre">PlotResults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MH_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#PlotResults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.PlotResults" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class to read in any completed refinement history file, create a Gaussain Process Optimizer
and then do sampling on the result to create a corner plot.</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>filename<span class="classifier">str</span></dt><dd><p>path to the file to load in the refinement history</p>
</dd>
<dt>quantiles<span class="classifier">list, optional</span></dt><dd><p>optional, list of the quantiles to be plotted on the corner plot, defaults
to [0.34, 0.5, 0.68], e.g. 1-sigma</p>
</dd>
<dt>MH_norm<span class="classifier">float, optional</span></dt><dd><p>The Metropolis-Hastings normalising factor to determine if points should be
kept or not, defaults to 20</p>
</dd>
<dt>points<span class="classifier">int, optional</span></dt><dd><p>Number of points to plot on the corner plot, defaults to 100,000</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.plot_results.PlotResults.create_cornerplot">
<span class="sig-name descname"><span class="pre">create_cornerplot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#PlotResults.create_cornerplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.PlotResults.create_cornerplot" title="Link to this definition"></a></dt>
<dd><p>Performs a random sample across the coordinate space giving a predicted figure of merit at
every point. Then removes points with poor figures of merit, according to a
Metropolis-Hastings type rule, where the likelihood of keeping a point is dependant on the
exponent of the difference between its figure of merit, and that of the best one found,
divided by MC_norm. A corner plot is then returned (a matplotlib figure object), which can
be displayed or exported.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corner plot</strong> – A plot displaying every parameter combination with their variances and covariances</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.plot_results.PlotResults.get_measured_points">
<span class="sig-name descname"><span class="pre">get_measured_points</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#PlotResults.get_measured_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.plot_results.PlotResults.get_measured_points" title="Link to this definition"></a></dt>
<dd><p>Opens the dataframe in <cite>filename</cite> and extracts the measured parameters names, values
and associated figures of merit.
Returns:
——–
tuple of (parameter names, parameter coordinates, min and max parameters, FoM’s)</p>
</dd></dl>

</section>
</dd></dl>

</section>
<section id="module-MDMC.control">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-MDMC.control" title="Link to this heading"></a></h2>
<p>Modules related to running a full MDMC refinement i.e. combining the MD
and refinement subpackages</p>
<section id="contents">
<h3>Contents<a class="headerlink" href="#contents" title="Link to this heading"></a></h3>
<p>Control</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="MDMC.control.Control">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MDMC.control.</span></span><span class="sig-name descname"><span class="pre">Control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="MDMC.MD.html#MDMC.MD.simulation.Simulation" title="MDMC.MD.simulation.Simulation"><span class="pre">Simulation</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_datasets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="MDMC.MD.html#MDMC.MD.parameters.Parameters" title="MDMC.MD.parameters.Parameters"><span class="pre">Parameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimizer_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'MMC'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FoM_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MD_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equilibration_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><span class="pre">Path</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_all_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.Control" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Controls the MDMC refinement</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation</strong> (<a class="reference internal" href="MDMC.MD.html#MDMC.MD.simulation.Simulation" title="MDMC.MD.simulation.Simulation"><em>Simulation</em></a>) – Performs a simulation for a given set of potential <code class="docutils literal notranslate"><span class="pre">Parameter</span></code>
objects.</p></li>
<li><p><strong>exp_datasets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><em>dicts</em>) – <p>Each <cite>dict</cite> represents an experimental dataset, containing the
following keys:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">file_name</span></code> (<cite>str</cite>) the file name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> (<cite>str</cite>) the type of observable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reader</span></code> (<cite>str</cite>) the reader required for the file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weighting</span></code> (<cite>float</cite>) the weighting of the dataset to be used in
the Figure of Merit calculation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resolution</span></code> : (<cite>dict</cite>, but can be <cite>str</cite>, <cite>float</cite>, or None)
Should be a one-line dict of format {‘file’ : str} or {key : float}
if {‘file’ : str}, the str should be a file in
the same format as <code class="docutils literal notranslate"><span class="pre">file_name</span></code> containing results of a vanadium
sample which is used to determine instrument energy resolution for
this dataset.
If {key : float}, the key should be the type of resolution function.
allowed types are ‘gaussian’ and ‘lorentzian’
Can also be ‘lazily’ given as just a <cite>str</cite> or <cite>float</cite>.
If just a string is given, it is assumed to be a filename.
If just a float is given, it is assumed to be Gaussian.
The float should be the instrument energy resolution as the FWHM in <code class="docutils literal notranslate"><span class="pre">ueV</span></code> (micro eV).
If you have already accounted for instrument resolution in your dataset,
this field can be set to None, and resolution application will be skipped.
This must be done explicitly.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rescale_factor</span></code> (<cite>float</cite>, optional, defaults to <cite>1.</cite>) applied to
the experimental data when calculating the FoM to ensure it is on
the same scale as the calculated observable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">auto_scale</span></code> (<cite>bool</cite>, optional, defaults to <cite>False</cite>) set the
<code class="docutils literal notranslate"><span class="pre">rescale_factor</span></code> automatically to minimise the FoM, if both
<code class="docutils literal notranslate"><span class="pre">rescale_factor</span></code> and <code class="docutils literal notranslate"><span class="pre">auto_scale</span></code> are provided then a warning
is printed and <code class="docutils literal notranslate"><span class="pre">auto_scale</span></code> takes precedence</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_FFT</span></code> (<cite>bool</cite>, optional, defaults to <cite>True</cite>) whether to use
Fast Fourier Transforms in the calculation of dependent variables.
FFT speeds up calculation but places restrictions on spacing in the
independent variable domain(s). This option may not be supported
for all <a href="#id3"><span class="problematic" id="id4">``</span></a>Observable``s</p></li>
</ul>
</div></blockquote>
<p>Note that the default (and preferred) behaviour of the scaling settings requires that the
dataset provided has been properly scaled and normalised for the refinement process.
Arbitrary or automatic rescaling should be undertaken with care, as it does not take into
account any physical aspects of scaling the data, such as the presence or absence of
background events from peaks outside its range.</p>
</p></li>
<li><p><strong>fit_parameters</strong> (<a class="reference internal" href="MDMC.MD.html#MDMC.MD.parameters.Parameters" title="MDMC.MD.parameters.Parameters"><em>Parameters</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference internal" href="MDMC.MD.html#MDMC.MD.parameters.Parameter" title="MDMC.MD.parameters.Parameter"><em>Parameter</em></a>) – All parameters which will be refined. Note that any <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> that is <code class="docutils literal notranslate"><span class="pre">fixed</span></code>,
<code class="docutils literal notranslate"><span class="pre">tied</span></code> or equal to 0 will not be passed to the minimizer as these cannot be refined.
Those with <code class="docutils literal notranslate"><span class="pre">constraints</span></code> set are still passed.</p></li>
<li><p><strong>minimizer_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The <code class="docutils literal notranslate"><span class="pre">Minimizer</span></code> type. Default is ‘MMC’.</p></li>
<li><p><strong>FoM_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> of </em><em>{str : str}</em><em>, </em><em>optional</em>) – <p>Defines the details of the <code class="docutils literal notranslate"><span class="pre">FigureOfMeritCalculator</span></code> to use. Default is <cite>None</cite>, in which
case the first option for each of the following keys is used:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">errors</span></code> {‘exp’, ‘none’} Whether to weight the differences between MD and
experimental data with the experimental error or not (errors from MD are not currently
supported).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">norm</span></code> {‘data_points’, ‘dof’, ‘none’} How to normalise the FoM, either by the total
number of data_points (n), the degrees of freedom (n - m, where m is the number of
parameters being varied), or not at all.</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>reset_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Determines if the configuration is reset to the end of the last accepted
state. Default is <cite>True</cite>.</p></li>
<li><p><strong>MD_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of molecular dynamics steps for each step of the refinement.
When not provided, the minimum number of steps needed for successful
calculation of the observables is used. If provided, the actual number
of steps may be reduced to prevent running MD that won’t be used when
calculating dependent variables. Default is <cite>None</cite>.</p></li>
<li><p><strong>equilibration_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of molecular dynamics steps used to equilibrate the <code class="docutils literal notranslate"><span class="pre">Universe</span></code>
in between each refinement step. When changes to the <code class="docutils literal notranslate"><span class="pre">Parameters</span></code> are small,
this equilibration can be much shorter than the equilibration needed before
starting the refinement process, but in general will vary depending on
the details of the <code class="docutils literal notranslate"><span class="pre">Universe</span></code> and <code class="docutils literal notranslate"><span class="pre">Parameters</span></code>. Default is 0.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The level of verbosity:
Verbose level -1 hides all outputs for tests.
Verbose level 0 gives no information.
Verbose level 1 gives final time for the whole method.
Verbose level 2 gives final time and also a progress bar.
Verbose level 3 gives final time, a progress bar, and time per step.</p></li>
<li><p><strong>print_full_settings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print all settings/attributes/parameters passed to this object,
defaults to False.</p></li>
<li><p><strong>**settings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <dl class="simple">
<dt>n_steps: int</dt><dd><p>The maximum number of refinement steps to be. An optional parameter that,
if specified, will be used in the <code class="docutils literal notranslate"><span class="pre">refine</span></code> method unless a different value
of <code class="docutils literal notranslate"><span class="pre">n_steps</span></code> is explicitly passed when running <code class="docutils literal notranslate"><span class="pre">refine</span></code>.</p>
</dd>
<dt>cont_slicing<span class="classifier">bool, optional</span></dt><dd><p>Flag to decide between two possible behaviours when the number of <code class="docutils literal notranslate"><span class="pre">MD_steps</span></code> is
larger than the minimum required to calculate the observables. If <code class="docutils literal notranslate"><span class="pre">False</span></code> (default)
then the <code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code> is sliced into non-overlapping sub-<code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code>
blocks for each of which the observable is calculated. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the
<code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code> is sliced into as many non-identical sub-<code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code>
blocks as possible (with overlap allowed).</p>
</dd>
<dt>results_filename: str</dt><dd><p>The name of the file in which the results of the MDMC run will be stored</p>
</dd>
<dt>MC_norm: int</dt><dd><p>1 if the MMC minimiser is to be used for parameter optimisation.</p>
</dd>
<dt>use_average<span class="classifier">bool, optional</span></dt><dd><p>Optional parameter relevant in case <code class="docutils literal notranslate"><span class="pre">MD_steps</span></code> is larger than the minimum required
and the MD <code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code> is sliced into sub-<code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code> blocks.
If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) the observables are averaged over the sub-<code class="docutils literal notranslate"><span class="pre">CompactTrajectory</span></code>
blocks. If <code class="docutils literal notranslate"><span class="pre">False</span></code> they are not averaged.</p>
</dd>
<dt>data_printer: str, default ‘plaintext’</dt><dd><p>How to display the data during minimisation. Current options are ‘plaintext’ (default,
plaintext printing) or ‘ipython’ (prettier HTML printing via iPython)</p>
</dd>
<dt>time_step_reductions<span class="classifier">int, optional</span></dt><dd><p>The number of attempts to reduce the time_step of the simulation in order to fix an
equilibration that keeps failing. Defaults to a value of 2.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>An example of an exp_dataset list is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;file_name&#39;</span><span class="p">:</span><span class="n">data</span><span class="o">.</span><span class="n">LAMP_SQW_FILE</span><span class="p">,</span>
  <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;SQw&#39;</span><span class="p">,</span>
  <span class="s1">&#39;reader&#39;</span><span class="p">:</span><span class="s1">&#39;LAMPSQw&#39;</span><span class="p">,</span>
  <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">,</span>
  <span class="s1">&#39;resolution&#39;</span><span class="p">:{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span><span class="n">data</span><span class="o">.</span><span class="n">LAMP_SQW_VAN_FILE</span><span class="p">}</span>
  <span class="s1">&#39;rescale_factor&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;file_name:data.ANOTHER_FILE&#39;</span><span class="p">,</span>
  <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;FQt&#39;</span><span class="p">,</span>
  <span class="s1">&#39;reader&#39;</span><span class="p">:</span><span class="s1">&#39;GENERIC_READER&#39;</span><span class="p">,</span>
  <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
  <span class="s1">&#39;resolution&#39;</span><span class="p">:{</span><span class="s1">&#39;gaussian&#39;</span><span class="p">:</span><span class="mf">2.35</span><span class="p">}</span>
  <span class="s1">&#39;auto_scale&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}]</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.Control.simulation">
<span class="sig-name descname"><span class="pre">simulation</span></span><a class="headerlink" href="#MDMC.control.Control.simulation" title="Link to this definition"></a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> on which is used to perform the refinement</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MDMC.MD.html#MDMC.MD.simulation.Simulation" title="MDMC.MD.simulation.Simulation">Simulation</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.Control.exp_datasets">
<span class="sig-name descname"><span class="pre">exp_datasets</span></span><a class="headerlink" href="#MDMC.control.Control.exp_datasets" title="Link to this definition"></a></dt>
<dd><p>One <cite>dict</cite> per experimental dataset used for the refinement</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>list of dicts</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.Control.fit_parameters">
<span class="sig-name descname"><span class="pre">fit_parameters</span></span><a class="headerlink" href="#MDMC.control.Control.fit_parameters" title="Link to this definition"></a></dt>
<dd><p>All <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> objects which will be refined</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MDMC.MD.html#MDMC.MD.parameters.Parameters" title="MDMC.MD.parameters.Parameters">Parameters</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.Control.minimizer">
<span class="sig-name descname"><span class="pre">minimizer</span></span><a class="headerlink" href="#MDMC.control.Control.minimizer" title="Link to this definition"></a></dt>
<dd><p>Refines the potential parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MDMC.refinement.minimizers.html#MDMC.refinement.minimizers.minimizer_abs.Minimizer" title="MDMC.refinement.minimizers.minimizer_abs.Minimizer">Minimizer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.Control.observable_pairs">
<span class="sig-name descname"><span class="pre">observable_pairs</span></span><a class="headerlink" href="#MDMC.control.Control.observable_pairs" title="Link to this definition"></a></dt>
<dd><p>Experimental observable/MD observable pairs which are used to calculate
the Figure of Merit</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>list</cite> of <code class="docutils literal notranslate"><span class="pre">ObservablePairs</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.Control.FoM_calculator">
<span class="sig-name descname"><span class="pre">FoM_calculator</span></span><a class="headerlink" href="#MDMC.control.Control.FoM_calculator" title="Link to this definition"></a></dt>
<dd><p>Calculates the FoM <cite>float</cite> from the <code class="docutils literal notranslate"><span class="pre">observable_pairs</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>FigureOfMeritCalculator</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDMC.control.Control.MD_steps">
<span class="sig-name descname"><span class="pre">MD_steps</span></span><a class="headerlink" href="#MDMC.control.Control.MD_steps" title="Link to this definition"></a></dt>
<dd><p>Number of molecular dynamics steps for each step of the refinement</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.Control.calculate_max_FoM">
<span class="sig-name descname"><span class="pre">calculate_max_FoM</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.calculate_max_FoM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.Control.calculate_max_FoM" title="Link to this definition"></a></dt>
<dd><p>Calculates a maximum Figure of Merit value by comparing a set of experimental observable
data, to arrays consisting of numbers close to zero. For use when the MD Engine fails with
a set of parameter values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>max_FoM</strong> – value of maximum FoM</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.Control.engine_recovery_from_equil">
<span class="sig-name descname"><span class="pre">engine_recovery_from_equil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.engine_recovery_from_equil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.Control.engine_recovery_from_equil" title="Link to this definition"></a></dt>
<dd><p>Handles an MDEngineError thrown by the MD engine. Currently this error is only raised by
LAMMPS.</p>
<p>The time_step is reduced, and the engine cleared, and then an equilibration is performed.
If the equilibration is unsuccessful when the attempt limit is reached, an MDEngineError is
raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of simulation steps to run.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print statements upon starting and completing the run.</p></li>
<li><p><strong>output_log</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Log file for the MD engine to write to.</p></li>
<li><p><strong>work_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Working directory for the MD engine to write to.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.Control.equilibrate">
<span class="sig-name descname"><span class="pre">equilibrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.equilibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.Control.equilibrate" title="Link to this definition"></a></dt>
<dd><p>Run molecular dynamics to equilibrate the <code class="docutils literal notranslate"><span class="pre">Universe</span></code>.</p>
<p>If the equilibration fails, a method to reduce the time_step and re-try, is called.
If this re-try also fails, then an MDEngineError is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of simulation steps to run.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print statements upon starting and completing the run.
Default is <cite>False</cite>.</p></li>
<li><p><strong>output_log</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Log file for the MD engine to write to. Default is <cite>None</cite>.</p></li>
<li><p><strong>work_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Working directory for the MD engine to write to. Default is <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.Control.minimize">
<span class="sig-name descname"><span class="pre">minimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimize_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.minimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.Control.minimize" title="Link to this definition"></a></dt>
<dd><p>Performs an MD run intertwined with periodic structure relaxation.
This way after a local minimum is found, the system is taken
out of the minimum to explore a larger volume of the parameter
space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Total number of the MD run steps</p></li>
<li><p><strong>minimize_every</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of MD steps between two consecutive minimizations</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print statements when the minimization has been started and completed
(including the number of minimization steps and time taken). Default is <cite>False</cite>.</p></li>
<li><p><strong>output_log</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Log file for the MD engine to write to. Default is <cite>None</cite>.</p></li>
<li><p><strong>work_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Working directory for the MD engine to write to. Default is <cite>None</cite>.</p></li>
<li><p><strong>**settings</strong> – <dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">etol</span></code> (<cite>float</cite>)</dt><dd><p>If the energy change between iterations is less than <code class="docutils literal notranslate"><span class="pre">etol</span></code>,
minimization is stopped. Default depends on engine used.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ftol</span></code> (<cite>float</cite>)</dt><dd><p>If the magnitude of the global force is less than <code class="docutils literal notranslate"><span class="pre">ftol</span></code>,
minimization is stopped. Default depends on engine used.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">maxiter</span></code> (<cite>int</cite>)</dt><dd><p>Maximum number of iterations of a single structure
relaxation procedure. Default depends on engine used.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">maxeval</span></code> (<cite>int</cite>)</dt><dd><p>Maximum number of force evaluations to perform. Default depends
on engine used.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.Control.plot_results">
<span class="sig-name descname"><span class="pre">plot_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MH_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.plot_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.Control.plot_results" title="Link to this definition"></a></dt>
<dd><p>Instantiates an insstance of the PlotResults class and generates a cornerplot
from the data in self.results_filename</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The filename and path to the history file. Defaults to None which
then uses self.results_filename</p></li>
<li><p><strong>points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The number of samples to initially generate, defaults to 100,000</p></li>
<li><p><strong>MH_norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – The denominator of the exponent, controlling how likley points are to be kept,
defaults to 20.0</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>corner plot</strong> – A plot displaying every parameter combination with their variances and covariances</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.Control.refine">
<span class="sig-name descname"><span class="pre">refine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.refine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.Control.refine" title="Link to this definition"></a></dt>
<dd><p>Refines the specified potential parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum number of steps for the refinement. Must be specified either when creating
the <code class="docutils literal notranslate"><span class="pre">Control</span></code> object or when calling this method. The value specified to this
method supersedes the value passed (if any) when the <code class="docutils literal notranslate"><span class="pre">Control</span></code> object was created.
If nothing is passed, the method will check if a number was specified when the
<code class="docutils literal notranslate"><span class="pre">Control</span></code> object was created and use that value.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Perform a refinement with a maximum of 100 steps:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>control.refine(100)</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.Control.reset_engine">
<span class="sig-name descname"><span class="pre">reset_engine</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.reset_engine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.Control.reset_engine" title="Link to this definition"></a></dt>
<dd><p>Clears and resets the MD engine when there is an error thrown by the
equilibration or production methods. Currently this is only applicable to LAMMPS.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.Control.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bad_param_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.Control.step" title="Link to this definition"></a></dt>
<dd><p>Do a full step: generate and run MD to calculate FoM for existing
parameters, iterate parameters a step forward and reset MD (phasespace)
if previous step was rejected and reset_config = true</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bad_param_location</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Represents whether the equilibration at these parameter value failed or not.
If equilibration failed, value is True.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.Control.trial_reduce_time_step">
<span class="sig-name descname"><span class="pre">trial_reduce_time_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduction_factor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/control.html#Control.trial_reduce_time_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.Control.trial_reduce_time_step" title="Link to this definition"></a></dt>
<dd><p>Reduces the time_step by the reduction factor specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>reduction_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – represents the value which will be multiplied with the time_step in order to reduce it</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MDMC.control.PlotResults">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MDMC.control.</span></span><span class="sig-name descname"><span class="pre">PlotResults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MH_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#PlotResults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.PlotResults" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class to read in any completed refinement history file, create a Gaussain Process Optimizer
and then do sampling on the result to create a corner plot.</p>
<section id="id5">
<h3>Parameters:<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>filename<span class="classifier">str</span></dt><dd><p>path to the file to load in the refinement history</p>
</dd>
<dt>quantiles<span class="classifier">list, optional</span></dt><dd><p>optional, list of the quantiles to be plotted on the corner plot, defaults
to [0.34, 0.5, 0.68], e.g. 1-sigma</p>
</dd>
<dt>MH_norm<span class="classifier">float, optional</span></dt><dd><p>The Metropolis-Hastings normalising factor to determine if points should be
kept or not, defaults to 20</p>
</dd>
<dt>points<span class="classifier">int, optional</span></dt><dd><p>Number of points to plot on the corner plot, defaults to 100,000</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.PlotResults.create_cornerplot">
<span class="sig-name descname"><span class="pre">create_cornerplot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#PlotResults.create_cornerplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.PlotResults.create_cornerplot" title="Link to this definition"></a></dt>
<dd><p>Performs a random sample across the coordinate space giving a predicted figure of merit at
every point. Then removes points with poor figures of merit, according to a
Metropolis-Hastings type rule, where the likelihood of keeping a point is dependant on the
exponent of the difference between its figure of merit, and that of the best one found,
divided by MC_norm. A corner plot is then returned (a matplotlib figure object), which can
be displayed or exported.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corner plot</strong> – A plot displaying every parameter combination with their variances and covariances</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDMC.control.PlotResults.get_measured_points">
<span class="sig-name descname"><span class="pre">get_measured_points</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a></span></span><a class="reference internal" href="../../_modules/MDMC/control/plot_results.html#PlotResults.get_measured_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDMC.control.PlotResults.get_measured_points" title="Link to this definition"></a></dt>
<dd><p>Opens the dataframe in <cite>filename</cite> and extracts the measured parameters names, values
and associated figures of merit.
Returns:
——–
tuple of (parameter names, parameter coordinates, min and max parameters, FoM’s)</p>
</dd></dl>

</section>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="MDMC.common.html" class="btn btn-neutral float-left" title="MDMC.common package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="MDMC.exporters.html" class="btn btn-neutral float-right" title="MDMC.exporters package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>